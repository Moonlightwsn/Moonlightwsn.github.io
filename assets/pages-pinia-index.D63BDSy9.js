import{d as t,C as e,af as a,m as r,a as l,w as o,q as d,c as n,o as s,e as u,i as c,h as f,t as g,u as i,_ as x,L as k,B as b,g as m,G as _,I as p,ag as v}from"./index-CQJqgjxr.js";import{_ as w,a as y}from"./wd-cell.CGONRzRX.js";import{_ as S}from"./DemoBlock.vue_vue_type_script_setup_true_lang.CYYVzenY.js";const h=t({__name:"index",setup(t){const{success:h}=e(),C=a("counter",()=>{const t=r(0),e=n(()=>2*t.value);return{count:t,doubleCount:e,increment:function(){t.value++},decrement:function(){t.value--},reset:function(){t.value=0}}}),I=a("user",()=>{const t=r({name:"",email:"",avatar:"",theme:"light"}),e=n(()=>!!t.value.name);return{userInfo:t,isLoggedIn:e,setUserInfo:function(e){t.value={...t.value,...e}},clearUserInfo:function(){t.value={name:"",email:"",avatar:"",theme:"light"}},toggleTheme:function(){t.value.theme="light"===t.value.theme?"dark":"light"}}}),$=a("temp",()=>{const t=r({message:"",timestamp:Date.now()});return{tempData:t,setMessage:function(e){t.value.message=e,t.value.timestamp=Date.now()},clearMessage:function(){t.value.message="",t.value.timestamp=Date.now()}}}),D=C(),V=I(),P=$(),U=r({name:"",email:""}),z=r("");function j(t){_({data:t,showToast:!1,success:()=>{p(),h({msg:"代码已复制到剪贴板"})}})}function A(){U.value.name?(V.setUserInfo({name:U.value.name,email:U.value.email,avatar:"😆"}),h({msg:"用户信息已保存（会持久化）"})):v({title:"请输入用户名",icon:"none"})}function L(){z.value?(P.setMessage(z.value),z.value="",h({msg:"临时消息已设置（不会持久化）"})):v({title:"请输入消息内容",icon:"none"})}function M(t){window.open(t,"_blank")}return(t,e)=>{const a=c,r=x,n=S,_=k,p=m,v=y,h=w,C=d("layout-default-uni");return s(),l(C,null,{default:o(()=>[u(a,{class:"min-h-screen bg-gray-100 py-3 dark:bg-[var(--wot-dark-background)]"},{default:o(()=>[u(a,{class:"mx-3 mb-3"},{default:o(()=>[u(a,{class:"rounded-3 bg-white px-5 py-8 text-center dark:bg-[var(--wot-dark-background2)]"},{default:o(()=>[u(a,{class:"mb-3 text-10"},{default:o(()=>[f(" 🍍 ")]),_:1}),u(a,{class:"mb-2 text-6 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" Pinia 状态管理 ")]),_:1}),u(a,{class:"mb-2 text-3.5 text-gray-600 leading-relaxed dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[f(" Vue 3 的直观状态管理库 ")]),_:1}),u(a,{class:"mb-2 text-3 text-gray-500 dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[f(" 轻量、类型安全、支持组合式API ")]),_:1}),u(a,{class:"text-3 text-gray-500 dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[f(" 本项目默认持久化所有 Store 数据，开发者可以配置排除列表 ")]),_:1})]),_:1})]),_:1}),u(n,{title:"基础使用 - 计数器",transparent:""},{default:o(()=>[u(a,{class:"rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]"},{default:o(()=>[u(a,{class:"mb-4 text-center"},{default:o(()=>[u(a,{class:"mb-2 text-8 text-blue-500"},{default:o(()=>[f(g(i(D).count),1)]),_:1}),u(a,{class:"text-3 text-gray-600 dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[f(" 双倍值: "+g(i(D).doubleCount),1)]),_:1})]),_:1}),u(a,{class:"grid grid-cols-3 mb-4 gap-2"},{default:o(()=>[u(r,{type:"success",size:"small",onClick:i(D).increment},{default:o(()=>[f(" +1 ")]),_:1},8,["onClick"]),u(r,{type:"warning",size:"small",onClick:i(D).decrement},{default:o(()=>[f(" -1 ")]),_:1},8,["onClick"]),u(r,{type:"info",size:"small",onClick:i(D).reset},{default:o(()=>[f(" 重置 ")]),_:1},8,["onClick"])]),_:1}),u(a,{class:"space-y-3"},{default:o(()=>[u(a,{class:"rounded bg-gray-100 p-3 dark:bg-[var(--wot-dark-background3)]"},{default:o(()=>[u(a,{class:"mb-2 text-3 text-gray-700 font-bold dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" 定义 Store: ")]),_:1}),u(a,{class:"text-2.5 text-gray-600 leading-relaxed font-mono dark:text-[var(--wot-dark-color2)]",onClick:e[0]||(e[0]=t=>j("const useCounterStore = defineStore('counter', () => {\n  const count = ref(0)\n  const doubleCount = computed(() => count.value * 2)\n\n  function increment() {\n    count.value++\n  }\n\n  return { count, doubleCount, increment }\n})"))},{default:o(()=>[f(" const useCounterStore = defineStore('counter', () => {\\n   const count = ref(0)\\n   const doubleCount = computed(() => count.value * 2)\\n   function increment() { count.value++ }\\n   return { count, doubleCount, increment }\\n }) ")]),_:1})]),_:1}),u(a,{class:"rounded bg-gray-100 p-3 dark:bg-[var(--wot-dark-background3)]"},{default:o(()=>[u(a,{class:"mb-2 text-3 text-gray-700 font-bold dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" 使用 Store: ")]),_:1}),u(a,{class:"text-2.5 text-gray-600 leading-relaxed font-mono dark:text-[var(--wot-dark-color2)]",onClick:e[1]||(e[1]=t=>j("const counterStore = useCounterStore()\n// 直接使用\ncounterStore.increment()\n// 响应式访问\nconsole.log(counterStore.count)"))},{default:o(()=>[f(" const counterStore = useCounterStore()\\n counterStore.increment() // 调用方法\\n console.log(counterStore.count) // 访问状态 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),u(n,{title:"持久化演示 - 用户信息",transparent:""},{default:o(()=>[u(a,{class:"mb-3 border border-green-200 rounded-2 bg-green-50 p-3 dark:border-green-800 dark:bg-green-900/20"},{default:o(()=>[u(a,{class:"mb-1 text-3.5 text-green-700 font-bold dark:text-green-300"},{default:o(()=>[f(" ✅ 持久化存储 ")]),_:1}),u(a,{class:"text-3 text-green-600 leading-relaxed dark:text-green-200"},{default:o(()=>[f(" 这个 Store 的数据会自动保存到本地存储，刷新页面后数据不会丢失 ")]),_:1})]),_:1}),u(a,{class:"space-y-4"},{default:o(()=>[u(a,{class:"rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]"},{default:o(()=>[u(a,{class:"mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" 当前用户信息 ")]),_:1}),i(V).isLoggedIn?(s(),l(a,{key:0,class:"flex items-center space-x-3"},{default:o(()=>[u(a,{class:"rounded-full text-12"},{default:o(()=>[f(g(i(V).userInfo.avatar),1)]),_:1}),u(a,{class:"flex-1"},{default:o(()=>[u(a,{class:"text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(g(i(V).userInfo.name),1)]),_:1}),u(a,{class:"text-3 text-gray-600 dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[f(g(i(V).userInfo.email),1)]),_:1})]),_:1})]),_:1})):(s(),l(a,{key:1,class:"text-center text-gray-500 dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[f(" 暂无用户信息 ")]),_:1}))]),_:1}),u(a,{class:"rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]"},{default:o(()=>[u(a,{class:"mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" 设置用户信息 ")]),_:1}),u(a,{class:"space-y-3"},{default:o(()=>[u(a,null,{default:o(()=>[u(a,{class:"mb-1 text-3 text-gray-700 dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" 用户名: ")]),_:1}),u(_,{modelValue:i(U).name,"onUpdate:modelValue":e[2]||(e[2]=t=>i(U).name=t),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),u(a,null,{default:o(()=>[u(a,{class:"mb-1 text-3 text-gray-700 dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" 邮箱: ")]),_:1}),u(_,{modelValue:i(U).email,"onUpdate:modelValue":e[3]||(e[3]=t=>i(U).email=t),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),u(a,{class:"grid grid-cols-2 gap-2"},{default:o(()=>[u(r,{type:"primary",onClick:A},{default:o(()=>[f(" 保存信息 ")]),_:1}),u(r,{type:"error",onClick:i(V).clearUserInfo},{default:o(()=>[f(" 清除信息 ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),u(n,{title:"非持久化演示 - 临时数据",transparent:""},{default:o(()=>[u(a,{class:"mb-3 border border-orange-200 rounded-2 bg-orange-50 p-3 dark:border-orange-800 dark:bg-orange-900/20"},{default:o(()=>[u(a,{class:"mb-1 text-3.5 text-orange-700 font-bold dark:text-orange-300"},{default:o(()=>[f(" ⚠️ 临时存储 ")]),_:1}),u(a,{class:"text-3 text-orange-600 leading-relaxed dark:text-orange-200"},{default:o(()=>[f(" 这个 Store 的数据不会持久化，刷新页面后数据会丢失 ")]),_:1})]),_:1}),u(a,{class:"rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]"},{default:o(()=>[u(a,{class:"mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" 临时消息 ")]),_:1}),i(P).tempData.message?(s(),l(a,{key:0,class:"mb-4 rounded-2 bg-blue-50 p-3 dark:bg-blue-900/20"},{default:o(()=>[u(a,{class:"text-3.5 text-blue-700 font-bold dark:text-blue-300"},{default:o(()=>[f(g(i(P).tempData.message),1)]),_:1}),u(a,{class:"text-2.5 text-blue-600 dark:text-blue-200"},{default:o(()=>[f(" 时间戳: "+g(new Date(i(P).tempData.timestamp).toLocaleString()),1)]),_:1})]),_:1})):(s(),l(a,{key:1,class:"mb-4 text-center text-gray-500 dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[f(" 暂无临时消息 ")]),_:1})),u(a,{class:"space-y-3"},{default:o(()=>[u(_,{modelValue:i(z),"onUpdate:modelValue":e[4]||(e[4]=t=>b(z)?z.value=t:null),placeholder:"请输入临时消息"},null,8,["modelValue"]),u(a,{class:"grid grid-cols-2 gap-2"},{default:o(()=>[u(r,{type:"primary",size:"small",onClick:L},{default:o(()=>[f(" 设置消息 ")]),_:1}),u(r,{type:"warning",size:"small",onClick:i(P).clearMessage},{default:o(()=>[f(" 清除消息 ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),u(n,{title:"持久化实现原理",transparent:""},{default:o(()=>[u(a,{class:"space-y-4"},{default:o(()=>[u(a,{class:"rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]"},{default:o(()=>[u(a,{class:"mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" 持久化插件 ")]),_:1}),u(a,{class:"mb-3 text-3 text-gray-600 leading-relaxed dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[f(" 项目使用自定义的 Pinia 插件实现持久化，位于 "),u(p,{class:"text-blue-600 font-mono dark:text-blue-400"},{default:o(()=>[f(" src/store/persist.ts ")]),_:1})]),_:1}),u(a,{class:"rounded bg-gray-100 p-3 dark:bg-[var(--wot-dark-background3)]",onClick:e[5]||(e[5]=t=>j("function persist({ store }, excludedIds) {\n  // 检查是否需要排除\n  if (excludedIds.includes(store.$id)) return\n\n  // 从本地存储读取数据\n  const storageState = uni.getStorageSync(store.$id)\n  if (storageState) {\n    store.$state = storageState\n  }\n\n  // 监听状态变化并保存\n  store.$subscribe(() => {\n    uni.setStorageSync(store.$id, store.$state)\n  })\n}"))},{default:o(()=>[u(a,{class:"mb-2 text-3 text-gray-700 font-bold dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" 核心实现: ")]),_:1}),u(a,{class:"text-2.5 text-gray-600 leading-relaxed font-mono dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[f(" function persist({ store }, excludedIds) {\\n   // 检查是否需要排除\\n   if (excludedIds.includes(store.$id)) return\\n   // 从本地存储读取数据\\n   const storageState = uni.getStorageSync(store.$id)\\n   // 监听状态变化并保存\\n   store.$subscribe(() => {\\n     uni.setStorageSync(store.$id, store.$state)\\n   })\\n } ")]),_:1})]),_:1})]),_:1}),u(a,{class:"rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]"},{default:o(()=>[u(a,{class:"mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" 排除列表 ")]),_:1}),u(a,{class:"mb-3 text-3 text-gray-600 leading-relaxed dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[f(" 可以通过排除列表控制哪些 Store 不需要持久化 ")]),_:1}),u(a,{class:"rounded bg-gray-100 p-3 dark:bg-[var(--wot-dark-background3)]",onClick:e[6]||(e[6]=t=>j("// 在 persist.ts 中配置排除列表\npersist(context, ['global-register', 'temp'])"))},{default:o(()=>[u(a,{class:"text-2.5 text-gray-600 leading-relaxed font-mono dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[f(" // 当前排除的 Store ID:\\n ['global-register', 'temp'] ")]),_:1})]),_:1})]),_:1}),u(a,{class:"rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]"},{default:o(()=>[u(a,{class:"mb-3 text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" 使用说明 ")]),_:1}),u(a,{class:"text-3 text-gray-600 leading-relaxed space-y-2 dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[u(a,null,{default:o(()=>[f(" • "),u(p,{class:"text-green-600 font-bold dark:text-green-400"},{default:o(()=>[f(" 自动持久化 ")]),_:1}),f("：默认情况下，所有 Store 都会自动持久化 ")]),_:1}),u(a,null,{default:o(()=>[f(" • "),u(p,{class:"text-orange-600 font-bold dark:text-orange-400"},{default:o(()=>[f(" 排除机制 ")]),_:1}),f("：通过 Store ID 控制哪些不需要持久化 ")]),_:1}),u(a,null,{default:o(()=>[f(" • "),u(p,{class:"text-blue-600 font-bold dark:text-blue-400"},{default:o(()=>[f(" 深拷贝保护 ")]),_:1}),f("：使用深拷贝避免引用问题 ")]),_:1}),u(a,null,{default:o(()=>[f(" • "),u(p,{class:"text-purple-600 font-bold dark:text-purple-400"},{default:o(()=>[f(" 自动恢复 ")]),_:1}),f("：页面刷新时自动从本地存储恢复数据 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),u(n,{title:"最佳实践",transparent:""},{default:o(()=>[u(a,{class:"space-y-3"},{default:o(()=>[u(a,{class:"rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]"},{default:o(()=>[u(a,{class:"mb-3 flex items-center"},{default:o(()=>[u(a,{class:"mr-2 text-6"},{default:o(()=>[f(" 💡 ")]),_:1}),u(a,{class:"text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" Store 设计建议 ")]),_:1})]),_:1}),u(a,{class:"text-3 text-gray-600 leading-relaxed space-y-2 dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[u(a,null,{default:o(()=>[f("• 使用组合式 API 风格定义 Store")]),_:1}),u(a,null,{default:o(()=>[f("• 合理拆分 Store，避免单个 Store 过于庞大")]),_:1}),u(a,null,{default:o(()=>[f("• 使用 TypeScript 获得更好的类型支持")]),_:1}),u(a,null,{default:o(()=>[f("• 为 Store 提供清晰的命名和注释")]),_:1})]),_:1})]),_:1}),u(a,{class:"rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]"},{default:o(()=>[u(a,{class:"mb-3 flex items-center"},{default:o(()=>[u(a,{class:"mr-2 text-6"},{default:o(()=>[f(" 🔒 ")]),_:1}),u(a,{class:"text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" 持久化建议 ")]),_:1})]),_:1}),u(a,{class:"text-3 text-gray-600 leading-relaxed space-y-2 dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[u(a,null,{default:o(()=>[f("• 敏感数据（如密码）不要持久化存储")]),_:1}),u(a,null,{default:o(()=>[f("• 大量数据考虑使用数据库而非本地存储")]),_:1}),u(a,null,{default:o(()=>[f("• 临时状态（如加载状态）不需要持久化")]),_:1}),u(a,null,{default:o(()=>[f("• 定期清理无用的持久化数据")]),_:1})]),_:1})]),_:1}),u(a,{class:"rounded-2 bg-white p-4 dark:bg-[var(--wot-dark-background2)]"},{default:o(()=>[u(a,{class:"mb-3 flex items-center"},{default:o(()=>[u(a,{class:"mr-2 text-6"},{default:o(()=>[f(" ⚡ ")]),_:1}),u(a,{class:"text-4 text-gray-800 font-bold dark:text-[var(--wot-dark-color)]"},{default:o(()=>[f(" 性能优化 ")]),_:1})]),_:1}),u(a,{class:"text-3 text-gray-600 leading-relaxed space-y-2 dark:text-[var(--wot-dark-color2)]"},{default:o(()=>[u(a,null,{default:o(()=>[f("• 避免在 Store 中存储大量数据")]),_:1}),u(a,null,{default:o(()=>[f("• 使用 computed 缓存复杂计算结果")]),_:1}),u(a,null,{default:o(()=>[f("• 合理使用 $subscribe 监听状态变化")]),_:1}),u(a,null,{default:o(()=>[f("• 考虑使用 $patch 批量更新状态")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),u(n,{title:"相关链接",transparent:""},{default:o(()=>[u(h,{border:"","custom-class":"rounded-2! overflow-hidden"},{default:o(()=>[u(v,{title:"📚 Pinia 官方文档",value:"状态管理库","is-link":"",onClick:e[7]||(e[7]=t=>M("https://pinia.vuejs.org/zh/"))}),u(v,{title:"🎯 Vue 3 文档",value:"组合式 API","is-link":"",onClick:e[8]||(e[8]=t=>M("https://cn.vuejs.org/guide/extras/composition-api-faq.html"))}),u(v,{title:"🔧 uni-app 存储",value:"本地存储 API","is-link":"",onClick:e[9]||(e[9]=t=>M("https://uniapp.dcloud.net.cn/api/storage/storage.html"))})]),_:1})]),_:1})]),_:1})]),_:1})}}});export{h as default};
