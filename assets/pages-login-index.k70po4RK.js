import{g as e,N as a,d as l,k as s,p as t,s as o,a2 as u,O as r,a3 as n,a4 as c,c as i,a as d,e as p,n as m,h as f,w as x,t as b,b as v,v as h,j as _,_ as g,a5 as y,H as V,B as k,a6 as w,r as $,A as S,a7 as C,D as B,y as z,C as j,X as q,F as A,G as F}from"./index-BAYT1_GE.js";import{_ as U}from"./BannerView.vue_vue_type_script_setup_true_lang.CfEUUJf5.js";import{_ as I}from"./wd-form.rXyRT9bU.js";import{_ as N}from"./PyText.vue_vue_type_script_setup_true_lang.na7fmCI6.js";import{_ as L}from"./SmsCodeBtn.vue_vue_type_script_setup_true_lang.DhLqWvJq.js";import"./wd-text.DuK9VuY3.js";const P=Symbol("wd-checkbox-group"),T=g(l({name:"wd-checkbox",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...e,customLabelClass:a(""),customShapeClass:a(""),modelValue:{type:[String,Number,Boolean],required:!0,default:!1},shape:{type:String},checkedColor:String,disabled:{type:[Boolean,null],default:null},trueValue:{type:[String,Number,Boolean],default:!0},falseValue:{type:[String,Number,Boolean],default:!1},size:String,maxWidth:String},emits:["change","update:modelValue"],setup(e,{expose:a,emit:l}){const g=e,y=l;a({toggle:U});const{parent:V,index:k}=s(P),w=t(()=>V?V.props.modelValue.indexOf(g.modelValue)>-1:g.modelValue===g.trueValue),$=t(()=>0===k.value),S=t(()=>{const e=o(V)?V.children:[];return k.value===e.length-1}),{proxy:C}=u();r(()=>g.modelValue,()=>{V&&V&&V.children&&V.children.forEach(e=>{e.$.uid!==C.$.uid&&e.modelValue===g.modelValue&&console.error(`The checkbox's bound value: ${g.modelValue} has been used`)})}),r(()=>g.shape,e=>{const a=["circle","square","button"];o(e)&&-1===a.indexOf(e)&&console.error(`shape must be one of ${a.toString()}`)});const B=t(()=>g.shape||n(V,"props.shape")||"circle"),z=t(()=>g.checkedColor||n(V,"props.checkedColor")),j=t(()=>{if(!V)return g.disabled;const{max:e,min:a,modelValue:l,disabled:s}=V.props;return!!(e&&l.length>=e&&!w.value||a&&l.length<=a&&w.value||!0===g.disabled||s&&null===g.disabled)||g.disabled}),q=t(()=>n(V,"props.inline")||!1),A=t(()=>n(V,"props.cell")||!1),F=t(()=>g.size||n(V,"props.size"));function U(){if(!j.value)if(V)y("change",{value:!w.value}),V.changeSelectState(g.modelValue);else{const e=g.modelValue===g.trueValue?g.falseValue:g.trueValue;y("update:modelValue",e),y("change",{value:e})}}return c(()=>{null===g.modelValue&&console.error("checkbox's value must be set")}),(e,a)=>{const l=p;return d(),i(l,{class:f(`wd-checkbox ${A.value?"is-cell-box":""} ${"button"===B.value?"is-button-box":""} ${w.value?"is-checked":""} ${$.value?"is-first-child":""} ${S.value?"is-last-child":""} ${q.value?"is-inline":""} ${"button"===B.value?"is-button":""} ${j.value?"is-disabled":""} ${F.value?"is-"+F.value:""} ${e.customClass}`),style:m(e.customStyle),onClick:U},{default:x(()=>["button"!==B.value?(d(),i(l,{key:0,class:f(`wd-checkbox__shape ${"square"===B.value?"is-square":""} ${e.customShapeClass}`),style:m(w.value&&!j.value&&z.value?"color :"+z.value:"")},{default:x(()=>[v(h,{"custom-class":"wd-checkbox__check",name:"check-bold"})]),_:1},8,["class","style"])):b("",!0),v(l,{class:f(`wd-checkbox__label ${e.customLabelClass}`),style:m(w.value&&"button"===B.value&&!j.value&&z.value?"color:"+z.value:"")},{default:x(()=>["button"===B.value&&w.value?(d(),i(h,{key:0,"custom-class":"wd-checkbox__btn-check",name:"check-bold"})):b("",!0),v(l,{class:"wd-checkbox__txt",style:m(e.maxWidth?"max-width:"+e.maxWidth:"")},{default:x(()=>[_(e.$slots,"default",{},void 0,!0)]),_:3},8,["style"])]),_:3},8,["class","style"])]),_:3},8,["class","style"])}}}),[["__scopeId","data-v-92af0321"]]),O=g(l({__name:"index",setup(e){const a=y(),l=V(),s=k(),t=w({agree:!1,code:"",mobile:""}),o=k(!1);async function u(){return await s.value.validate()}async function r(){if(o.value)return;const{valid:e}=await u();if(e)if(t.agree)try{o.value=!0;const e=await q.app.smsLogin({data:{...t}}),{accessToken:s}=(null==e?void 0:e.data)||{};s?(a.value=s,j({icon:"success",title:"登录成功",success(){setTimeout(()=>{l.replaceAll({name:"index"})},1e3)}})):j({icon:"error",title:(null==e?void 0:e.msg)||"登录失败"})}finally{o.value=!1}else j({icon:"error",title:"请阅读并同意用户协议"})}const n=/^\d{11}$/;function c(e){return!(t.mobile&&n.test(t.mobile)&&!e)}const m=k(!1);async function f(){var e,a;if(!m.value)try{A({title:"加载中"}),m.value=!0;const l=await q.app.caRegisterSign();if(0===l.code&&l.data){const{baseUrl:s,path:t,clientId:o,timestamp:u,signature:r,redirectUri:n,appBizNo:c}=l.data,i=(e=`${s}${t}`,a={client_env:"h5",client_id:o,timestamp:u,signature:r,redirect_uri:n,app_biz_no:c},`${e}?${new URLSearchParams({...a,timestamp:a.timestamp.toString()}).toString()}`);window.location.href=i}}finally{F(),m.value=!1}}function b(e){l.push({name:"agreement",params:{type:e}})}return(e,a)=>{const l=C,h=T,_=N,g=p,y=B,V=I,k=U,w=$("layout-default-uni");return d(),i(w,null,{default:x(()=>[v(k,{fixed:!1,"custom-class":"bg-white login-page","banner-src":S("/assets/login-bg-BD7CSFAJ.png"),"banner-height":"332rpx"},{default:x(()=>[v(g,{class:"py-60rpx px-56rpx flex h-full flex-grow flex-col"},{default:x(()=>[v(V,{ref_key:"form",ref:s,"custom-class":"gap-16rpx flex flex-col",model:S(t)},{default:x(()=>[v(l,{modelValue:S(t).mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>S(t).mobile=e),prop:"mobile",rules:[{required:!0,message:"请输入手机号"},{required:!1,pattern:n,message:"手机号格式不正确"}],"custom-class":"rounded-10rpx px-28rpx","no-border":"",type:"digit","input-mode":"numeric",placeholder:"请输入手机号"},null,8,["modelValue","rules"]),v(l,{modelValue:S(t).code,"onUpdate:modelValue":a[1]||(a[1]=e=>S(t).code=e),prop:"code",rules:[{required:!1,validator:c,message:"请输入验证码"}],"custom-class":"rounded-10rpx px-28rpx","no-border":"",type:"text","input-mode":"text",placeholder:"请输入验证码"},{suffix:x(()=>[v(L,{mobile:S(t).mobile,"is-admin":!1,onValidate:u,onRegister:f},null,8,["mobile"])]),_:1},8,["modelValue","rules"]),v(g,{class:"mt-100rpx flex items-start"},{default:x(()=>[v(h,{modelValue:S(t).agree,"onUpdate:modelValue":a[2]||(a[2]=e=>S(t).agree=e),shape:"square","custom-class":"mt-12rpx"},null,8,["modelValue"]),v(g,{class:""},{default:x(()=>[v(_,{text:"我已阅读并同意"}),v(_,{text:"《用户协议》",color:"#29A2FB",onClick:a[3]||(a[3]=e=>b("user"))}),v(_,{text:"《隐私协议》",color:"#29A2FB",onClick:a[4]||(a[4]=e=>b("privacy"))}),v(_,{text:"《授权协议》",color:"#29A2FB",onClick:a[5]||(a[5]=e=>b("grant"))})]),_:1})]),_:1}),v(y,{type:"primary",block:"",size:"large",round:!1,disabled:o.value,onClick:r},{default:x(()=>[z(" 登录 ")]),_:1},8,["disabled"]),v(g,{class:"mt-50rpx flex justify-center"},{default:x(()=>[v(_,{text:"还没有账号？"}),v(_,{text:"立即注册",color:m.value?"#666":"#29A2FB",onClick:f},null,8,["color"])]),_:1})]),_:1},8,["model"]),v(g,{class:"flex-grow"}),v(g,{class:"flex flex-col items-center"},{default:x(()=>[v(_,{text:"浦江数链提供技术支持",color:"#999",size:"24rpx"}),v(_,{text:"沪ICP备2023032312号-1",color:"#999",size:"24rpx"})]),_:1})]),_:1})]),_:1},8,["banner-src"])]),_:1})}}}),[["__scopeId","data-v-862f4e46"]]);export{O as default};
