import{_ as e}from"./Descriptions.vue_vue_type_script_setup_true_lang.Bu1yKr76.js";import{_ as a}from"./wd-divider.DmdDC7_O.js";import{g as l,Q as s,m as t,f as c,d as u,l as o,B as r,R as d,o as n,p as i,q as p,ar as h,c as m,a as f,e as v,n as _,h as y,w as x,b,j as w,t as g,v as k,x as C,y as V,z as j,A as D,T as I,_ as $,a8 as S,aa as E,as as F,r as A,M as T,N as z,O as L,G as O,F as U,$ as Y,at as M}from"./index-Bly4hIk5.js";import{_ as N}from"./PyTitle.Cr1dk33U.js";import{u as P,_ as W}from"./usePaged.BNwJwJlH.js";import{_ as B,a as G}from"./wd-tab.Wv5vsefu.js";import{f as q}from"./index.Lf5rPU8V.js";import"./wd-col.CCMEXLTH.js";const H=$(u({name:"wd-search",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...l,customInputClass:s(""),modelValue:s(""),useSuffixSlot:t(!1),placeholder:String,cancelTxt:String,light:t(!1),hideCancel:t(!1),disabled:t(!1),maxlength:c(-1),placeholderLeft:t(!1),focus:t(!1),focusWhenClear:t(!1),placeholderStyle:String,placeholderClass:s("")},emits:["update:modelValue","change","clear","search","focus","blur","cancel"],setup(e,{emit:a}){const l=e,s=a,{translate:t}=o("search"),c=r(!1),u=r(!1),$=r(""),S=r(!0),E=r(!1);d(()=>l.modelValue,e=>{$.value=e,e&&(u.value=!0)},{immediate:!0}),d(()=>l.focus,e=>{if(e){if(l.disabled)return;z()}}),n(()=>{l.focus&&z()});const F=i(()=>`wd-search  ${l.light?"is-light":""}  ${l.hideCancel?"is-without-cancel":""} ${l.customClass}`),A=i(()=>{const e={display:""===$.value&&S.value?"flex":"none"};return p(e)});async function T(e){u.value=e,await h(),c.value=e}async function z(){l.disabled||(await h(100),S.value=!1,T(!0))}function L(e){$.value=e.detail.value,s("update:modelValue",e.detail.value),s("change",{value:e.detail.value})}async function O(){$.value="",l.focusWhenClear&&(E.value=!0,c.value=!1),await h(),l.focusWhenClear?(S.value=!1,T(!0)):(S.value=!0,T(!1)),s("change",{value:""}),s("update:modelValue",""),s("clear")}function U({detail:{value:e}}){s("search",{value:e})}function Y(){S.value=!1,s("focus",{value:$.value})}async function M(){await h(150),E.value?E.value=!1:(S.value=!$.value,u.value=!S.value,c.value=!1,s("blur",{value:$.value}))}function N(){s("cancel",{value:$.value})}return(e,a)=>{const l=C,s=v,o=I;return f(),m(s,{class:y(F.value),style:_(e.customStyle)},{default:x(()=>[b(s,{class:"wd-search__block"},{default:x(()=>[w(e.$slots,"prefix",{},void 0,!0),b(s,{class:"wd-search__field"},{default:x(()=>[e.placeholderLeft?g("",!0):(f(),m(s,{key:0,style:_(A.value),class:"wd-search__cover",onClick:z},{default:x(()=>[b(k,{name:"search","custom-class":"wd-search__search-icon"}),b(l,{class:y(`wd-search__placeholder-txt ${e.placeholderClass}`)},{default:x(()=>[V(j(e.placeholder||D(t)("search")),1)]),_:1},8,["class"])]),_:1},8,["style"])),u.value||$.value||e.placeholderLeft?(f(),m(k,{key:1,name:"search","custom-class":"wd-search__search-left-icon"})):g("",!0),u.value||$.value||e.placeholderLeft?(f(),m(o,{key:2,placeholder:e.placeholder||D(t)("search"),"placeholder-class":`wd-search__placeholder-txt ${e.placeholderClass}`,"placeholder-style":e.placeholderStyle,"confirm-type":"search",modelValue:$.value,"onUpdate:modelValue":a[0]||(a[0]=e=>$.value=e),class:y(["wd-search__input",e.customInputClass]),onFocus:Y,onInput:L,onBlur:M,onConfirm:U,disabled:e.disabled,maxlength:e.maxlength,focus:c.value},null,8,["placeholder","placeholder-class","placeholder-style","modelValue","class","disabled","maxlength","focus"])):g("",!0),$.value?(f(),m(k,{key:3,"custom-class":"wd-search__clear wd-search__clear-icon",name:"error-fill",onClick:O})):g("",!0)]),_:1})]),_:3}),e.hideCancel?g("",!0):w(e.$slots,"suffix",{key:0},()=>[b(s,{class:"wd-search__cancel",onClick:N},{default:x(()=>[V(j(e.cancelTxt||D(t)("cancel")),1)]),_:1})],!0)]),_:3},8,["class","style"])}}}),[["__scopeId","data-v-7650d631"]]),K=$(u({__name:"auth",setup(l){const s=[{key:"999",title:"全部"},{key:"1",title:"已授权"},{key:"0",title:"未授权"}],t=S({name:"",tab:"999"});const{list:c,reload:u}=P(async function(e){const a=await Y.app.getAppAuthPage({params:{...e,name:t.name||void 0,status:"999"===t.tab?void 0:Number(t.tab)}}),{code:l,data:s}=a||{};if(0!==l||!s)throw new Error("获取数据失败");return s}),o=M(u,600);d(()=>t.name,(e,a)=>{e!==a&&o()}),d(()=>t.tab,(e,a)=>{e!==a&&u()});const{confirm:r}=E(),{loading:n,close:i}=F();function p(e,a){if(!e)return;const l=0===a?1:0;r({title:"提示",msg:0===a?"确认要授权给该商户么？":"确认取消授权？取消后该商户无法再为您发放到场数字存根，可能会影响您后续相关权益领取。",success:async()=>{n("正在更新..."),await Y.app.updateAppAuthTenant({data:{id:e,status:l}});const a=c.value.findIndex(a=>a.id===e);-1!==a&&c.value.splice(a,1,{...c.value[a],status:l}),i()}})}return(l,u)=>{const o=H,r=G,d=B,n=v,i=W,h=O,_=N,y=U,w=a,k=e,C=A("layout-default-uni");return f(),m(C,null,{default:x(()=>[b(n,{class:"tenant-auth pt-54rpx px-30rpx min-h-screen w-screen bg-white"},{default:x(()=>[b(n,null,{default:x(()=>[b(o,{"custom-class":"border-#DFE6ED border-solid border-2rpx rounded-100rpx",placeholder:"搜索授权商户",modelValue:D(t).name,"onUpdate:modelValue":u[0]||(u[0]=e=>D(t).name=e),"hide-cancel":""},null,8,["modelValue"]),b(d,{type:"long",modelValue:D(t).tab,"onUpdate:modelValue":u[1]||(u[1]=e=>D(t).tab=e),class:"mb-16rpx"},{default:x(()=>[(f(),T(z,null,L(s,e=>b(r,{key:e.key,title:`${e.title}`,name:e.key},null,8,["title","name"])),64))]),_:1},8,["modelValue"])]),_:1}),0===D(c).length?(f(),m(n,{key:0},{default:x(()=>[b(i)]),_:1})):g("",!0),(f(!0),T(z,null,L(D(c),e=>(f(),m(n,{key:e.id,class:"bg-#EFF2F5 rounded-18rpx py-30rpx px-34rpx mb-20rpx"},{default:x(()=>[b(n,{class:"gap-24rpx flex items-center"},{default:x(()=>[b(h,{"custom-class":"rounded-10rpx overflow-hidden",src:e.authObjectLogoUrl,width:"80rpx",height:"80rpx"},null,8,["src"]),b(_,{text:e.authObjectName,size:"36rpx","line-height":"54rpx"},null,8,["text"]),b(n,{class:"flex-grow"}),0===e.status?(f(),m(y,{key:0,size:"small",onClick:a=>p(e.id,e.status)},{default:x(()=>[V(" 去授权 ")]),_:2},1032,["onClick"])):g("",!0),1===e.status?(f(),m(y,{key:1,size:"small",type:"error",plain:"",onClick:a=>p(e.id,e.status)},{default:x(()=>[V(" 取消授权 ")]),_:2},1032,["onClick"])):g("",!0)]),_:2},1024),b(w,{class:"!my-20rpx !mx-0 !p-0",dashed:"",color:"#DFE6ED"}),b(k,{"value-color":"#333",data:[{label:"授权内容：",value:"到场证明"},{label:"授权时间：",value:D(q)(e.authTime,"YYYY年MM月DD日")},{label:"商户DID：",value:e.authObjectDid}]},null,8,["data"])]),_:2},1024))),128))]),_:1})]),_:1})}}}),[["__scopeId","data-v-b8d9d8d5"]]);export{K as default};
