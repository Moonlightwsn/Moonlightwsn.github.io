import{c as e,m as t,al as r,am as n,an as a,ao as o,ap as u,aq as i,ar as c,as as s,at as l,p as f}from"./index-CQJqgjxr.js";var p=Object.defineProperty,v=Object.defineProperties,m=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,g=(e,t,r)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const w=t([]),P=e(()=>w.value.length),y=e(()=>{var e;return null==(e=w.value)?void 0:e[P.value-1]}),O=e(()=>{var e;return P.value>1?w.value[P.value-2]:null==(e=w.value)?void 0:e[P.value-1]}),j=e(()=>{var e;return(null==(e=y.value)?void 0:e.route)||"/"}),B=e(()=>{var e;return null==(e=O.value)?void 0:e.route});let T=[],k=!1,x=!1;function L(){k||(k=!0,r("navigateTo",{complete:W}),r("redirectTo",{complete:W}),r("reLaunch",{complete:W}),r("switchTab",{complete:W}),r("navigateBack",{complete:W})),x||(x=!0,async function(e,t,r={}){const{retry:n=3,interval:a=500}=r;function o(){const r=t||c();return!!r&&(i(e,r),!0)}for(let u=1;u<=n;u++){if(o())return;await A(a)}throw new Error("Binding onBackPress failed, maximum number of attempts exceeded.")}(e=>{"navigateBack"!==e.from&&W()}).catch(()=>{x=!1})),W()}function W(){w.value=u()}function $(e,t,r){let{fail:n,success:a,complete:o}=e;return n=n||(e=>e),a=a||(e=>e),o=o||(()=>{}),u=((e,t)=>{for(var r in t||(t={}))b.call(t,r)&&g(e,r,t[r]);if(d)for(var r of d(t))h.call(t,r)&&g(e,r,t[r]);return e})({},e),v(u,m({success:e=>t(a(e)),fail:e=>r(n(e)),complete:o}));var u}function E(e){return new Promise((t,r)=>{o($(e,t,r))})}function U(e){return new Promise((t,r)=>{s($(e,t,r))})}function S(e){return new Promise((t,r)=>{l($(e,t,r))})}function q(e){return new Promise((t,r)=>{a($(e,t,r))})}function D(e){return new Promise((t,r)=>{n($(e||{},t,r))})}function I(e,t,r){if(!e)return t(r);if(0===T.length)return E(r).catch(()=>t(r));return function(e){const t=z(e);return!!T.find(e=>`/${e.pagePath}`===t)}("string"==typeof r.url?r.url:r.url.toString())?E(r):t(r)}function R(e={}){L();const{tryTabBar:t=!0}=e;return e.tabBarList&&(T=e.tabBarList),{pages:w,current:y,page:y,currentUrl:j,route:j,prev:O,prevPage:O,prevUrl:B,prevRoute:B,switchTab:E,navigate:function(e){return I(t,U,e)},redirect:function(e){return I(t,S,e)},reLaunch:q,back:D}}function z(e,t){if(e.startsWith("/"))return e;if(!t){const{currentUrl:e}=R();t=e.value}if(!t)throw new Error("The current path is undefined and cannot be found.");if(!e)return t;if(e.startsWith("./"))return z(e.slice(2),t);let r=[];t.endsWith("/")?r=t.split("/").filter(e=>""!==e&&"."!==e):(r=t.split("/"),r.pop(),r=r.filter(e=>""!==e&&"."!==e));let n=[],a="";e.endsWith("/")?n=e.split("/").filter(e=>""!==e&&"."!==e):(n=e.split("/"),a=n.pop()||"",n=n.filter(e=>""!==e&&"."!==e));const o=[...r,...n],u=[];for(const i of o)".."===i?u.pop():u.push(i);return`/${u.join("/")}/${a}`}function A(e=0){return new Promise(t=>setTimeout(t,e))}function C(e){const t=function(){const{page:e}=R();return e}();f(()=>{var r;const n=null==(r=t.value.$vm)?void 0:r.options;e(n)})}export{C as u};
