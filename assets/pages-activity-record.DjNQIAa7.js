import{_ as t}from"./ActivityListItem.DER4T0LI.js";import{u as s,_ as i}from"./usePaged.CElQBFki.js";import{d as e,H as a,c as r,w as o,r as n,a as u,b as l,e as p,t as c,V as d,A as m,W as v,X as h,P as _}from"./index-a6TtsOgc.js";import"./wd-divider.BUjIEoaI.js";import"./PyText.vue_vue_type_script_setup_true_lang.C4vd1DLX.js";import"./wd-text.O2Z1f8vu.js";import"./Avatar.vue_vue_type_script_setup_true_lang.ex313Ryk.js";import"./PyTitle.CL2zNIOD.js";import"./index.CVFvtcrF.js";import"./_commonjsHelpers.lGe4XDVY.js";const y=e({__name:"record",setup(e){const y=a(),f=t=>({id:(null==t?void 0:t.id)||Date.now().toString(),img:(null==t?void 0:t.picUrl)||"",title:(null==t?void 0:t.name)||"未命名数根"}),g=t=>{const s=[];t.issueProduct&&(Array.isArray(t.issueProduct)?s.push(...t.issueProduct.map(t=>f(t))):s.push(f(t.issueProduct)));const i=[];var e;t.issueVoucher&&(Array.isArray(t.issueVoucher)?i.push(...t.issueVoucher.map(t=>f(t))):i.push({id:(null==(e=t.issueVoucher)?void 0:e.id)||Date.now().toString(),img:(null==e?void 0:e.picUrl)||"",title:(null==e?void 0:e.name)||"未命名权益"}));const a=[];return t.attendedUsers&&t.attendedUsers.forEach(t=>{a.push((t=>({avatar:null==t?void 0:t.avatar}))(t))}),{...t,pythrootList:s,profitList:i,participants:a}};const{list:x}=s(async function(t){const s=await _.app.getActivityAttendancePage({params:{...t}}),{code:i,data:e}=s||{};if(0!==i||!e)throw new Error("获取数据失败");console.log("data",e);const a=(e.list||[]).map(t=>g(t));return console.log(a),{list:a,total:e.total||0}});return(s,e)=>{const a=i,_=p,f=t,g=n("layout-default-uni");return u(),r(g,null,{default:o(()=>[l(_,{class:"px-30rpx pt-40rpx pb-158rpx gap-20rpx flex min-h-screen flex-col bg-white"},{default:o(()=>[0===m(x).length?(u(),r(_,{key:0},{default:o(()=>[l(a)]),_:1})):c("",!0),(u(!0),d(v,null,h(m(x),t=>(u(),r(f,{key:t.id,"attend-count":t.attendCount,border:!0,"show-status":!1,"cover-img-src":t.picUrl||"",title:t.name,location:t.address||"","start-time":t.startTime,"end-time":t.endTime,participants:t.participants,"pythroot-list":t.pythrootList,"profit-list":t.profitList,status:t.timeStatus,"time-status":t.timeStatus,onClick:s=>{return i=t.id,void y.push({name:"activityDetail",params:{id:String(i)}});var i}},null,8,["attend-count","cover-img-src","title","location","start-time","end-time","participants","pythroot-list","profit-list","status","time-status","onClick"]))),128))]),_:1})]),_:1})}}});export{y as default};
