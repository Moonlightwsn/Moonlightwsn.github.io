import{p as e,aD as t,aT as n,aU as r,m as a,aV as o,S as i,ar as s,aW as u,aX as l,ai as c,c as f,aY as v,u as d}from"./index-Do2xWgh4.js";function p(e){return!!u()&&(l(e),!0)}const g="undefined"!=typeof window&&"undefined"!=typeof document;"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope);const y=Object.prototype.toString,w=()=>{};function m(...e){if(1!==e.length)return n(...e);const t=e[0];return"function"==typeof t?r(o(()=>({get:t,set:w}))):a(t)}const S=e=>e();function h(e){return Array.isArray(e)?e:[e]}function b(e,t,n={}){const{eventFilter:r=S,...a}=n;return i(e,(o=r,s=t,function(...e){return new Promise((t,n)=>{Promise.resolve(o(()=>s.apply(this,e),{fn:s,thisArg:this,args:e})).then(t).catch(n)})}),a);var o,s}function A(e,t,n={}){const{eventFilter:a,initialState:o="active",...i}=n,{eventFilter:s,pause:u,resume:l,isActive:c}=function(e=S,t={}){const{initialState:n="active"}=t,a=m("active"===n);return{isActive:r(a),pause:function(){a.value=!1},resume:function(){a.value=!0},eventFilter:(...t)=>{a.value&&e(...t)}}}(a,{initialState:o});return{stop:b(e,t,{...i,eventFilter:s}),pause:u,resume:l,isActive:c}}function O(n,r=!0,a){s()?e(n,a):r?n():t(n)}const N=g?window:void 0;function j(e){var t;const n=v(e);return null!=(t=null==n?void 0:n.$el)?t:n}function F(...e){const t=[],n=()=>{t.forEach(e=>e()),t.length=0},r=f(()=>{const t=h(v(e[0])).filter(e=>null!=e);return t.every(e=>"string"!=typeof e)?t:void 0}),a=(o=([e,r,a,o])=>{if(n(),!(null==e?void 0:e.length)||!(null==r?void 0:r.length)||!(null==a?void 0:a.length))return;const i=(s=o,"[object Object]"===y.call(s)?{...o}:o);var s;t.push(...e.flatMap(e=>r.flatMap(t=>a.map(n=>((e,t,n,r)=>(e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)))(e,t,n,i)))))},s={flush:"post"},i(()=>{var t,n;return[null!=(n=null==(t=r.value)?void 0:t.map(e=>j(e)))?n:[N].filter(e=>null!=e),h(v(r.value?e[1]:e[0])),h(d(r.value?e[2]:e[1])),v(r.value?e[3]:e[2])]},o,{...s,immediate:!0}));var o,s;return p(n),()=>{a(),n()}}function E(){const t=c(!1),n=s();return n&&e(()=>{t.value=!0},n),t}function D(e){const t=E();return f(()=>(t.value,Boolean(e())))}const I="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},J="__vueuse_ssr_handlers__",_=k();function k(){return J in I||(I[J]=I[J]||{}),I[J]}const M={boolean:{read:e=>"true"===e,write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},T="vueuse-storage";function V(e,n,r,o={}){var s;const{flush:u="pre",deep:l=!0,listenToStorageChanges:d=!0,writeDefaults:p=!0,mergeDefaults:g=!1,shallow:y,window:w=N,eventFilter:m,onError:S=e=>{console.error(e)},initOnMounted:h}=o,b=(y?c:a)(n),j=f(()=>v(e));if(!r)try{r=function(e,t){return _[e]||t}("getDefaultStorage",()=>{var e;return null==(e=N)?void 0:e.localStorage})()}catch(C){S(C)}if(!r)return b;const E=v(n),D=function(e){return null==e?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":"boolean"==typeof e?"boolean":"string"==typeof e?"string":"object"==typeof e?"object":Number.isNaN(e)?"any":"number"}(E),I=null!=(s=o.serializer)?s:M[D],{pause:J,resume:k}=A(b,e=>function(e){try{const t=r.getItem(j.value);if(null==e)W(t,null),r.removeItem(j.value);else{const n=I.write(e);t!==n&&(r.setItem(j.value,n),W(t,n))}}catch(C){S(C)}}(e),{flush:u,deep:l,eventFilter:m});i(j,()=>x(),{flush:u});let V=!1;const z=e=>{h&&!V||x(e.detail)};function W(e,t){if(w){const n={key:j.value,oldValue:e,newValue:t,storageArea:r};w.dispatchEvent(r instanceof Storage?new StorageEvent("storage",n):new CustomEvent(T,{detail:n}))}}function x(e){if(!e||e.storageArea===r)if(e&&null==e.key)b.value=E;else if(!e||e.key===j.value){J();try{const t=I.write(b.value);void 0!==e&&(null==e?void 0:e.newValue)===t||(b.value=function(e){const t=e?e.newValue:r.getItem(j.value);if(null==t)return p&&null!=E&&r.setItem(j.value,I.write(E)),E;if(!e&&g){const e=I.read(t);return"function"==typeof g?g(e,E):"object"!==D||Array.isArray(e)?e:{...E,...e}}return"string"!=typeof t?t:I.read(t)}(e))}catch(C){S(C)}finally{e?t(k):k()}}}return w&&d&&(r instanceof Storage?F(w,"storage",e=>{h&&!V||x(e)},{passive:!0}):F(w,T,z)),h?O(()=>{V=!0,x()}):x(),b}function z(e,t,n={}){const{window:r=N,...a}=n;let o;const s=D(()=>r&&"ResizeObserver"in r),u=()=>{o&&(o.disconnect(),o=void 0)},l=f(()=>{const t=v(e);return Array.isArray(t)?t.map(e=>j(e)):[j(t)]}),c=i(l,e=>{if(u(),s.value&&r){o=new ResizeObserver(t);for(const t of e)t&&o.observe(t,a)}},{immediate:!0,flush:"post"}),d=()=>{u(),c()};return p(d),{isSupported:s,stop:d}}export{z as a,g as i,m as t,V as u};
