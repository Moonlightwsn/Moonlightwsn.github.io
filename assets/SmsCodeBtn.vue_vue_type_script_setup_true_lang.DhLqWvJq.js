import{d as e,B as a,p as t,c as s,a as n,D as o,A as i,w as c,y as l,t as d,x as r,z as m,aT as u,aU as p,X as v,C as b}from"./index-BAYT1_GE.js";const f=e({name:"SmsCodeBtn",__name:"SmsCodeBtn",props:{isAdmin:{type:Boolean},mobile:{}},emits:["validate","register"],setup(e,{emit:f}){const h=e,y=f,C=a(0),g=t(()=>C.value>0),w=/^\d{11}$/;let S;function _(){clearInterval(S),C.value=0}async function x(){if(!g.value)if(w.test(h.mobile))try{_(),C.value=60,S=setInterval(()=>{C.value-=1},996),h.isAdmin?await u.general.checkOutSendLoginSmsCode({data:{mobile:h.mobile,scene:21}}).catch(e=>{throw 1002000007===e.code&&p({title:"提示",content:"用户还未注册，请联系管理员开通账户？"}),e}):await v.app.sendSmsCode({data:{mobile:h.mobile,scene:1}}).catch(e=>{throw 1004001001===e.code&&p({title:"提示",content:"用户还未注册，是否前往注册？",success({confirm:e}){e&&y("register")}}),e}),b({icon:"success",title:"验证码已发送"})}catch(e){_(),console.log(e)}else y("validate")}return(e,a)=>{const t=r,u=o;return n(),s(u,{type:"text",disabled:i(g),onClick:x},{default:c(()=>[l(" 获取验证码 "),i(C)>0?(n(),s(t,{key:0},{default:c(()=>[l("("+m(i(C))+")",1)]),_:1})):d("",!0)]),_:1},8,["disabled"])}}});export{f as _};
