import{_ as t}from"./BannerView.vue_vue_type_script_setup_true_lang.DzP9QOFw.js";import{_ as i,a}from"./activity-cover.rsNa2DSu.js";import{u as s,_ as e}from"./usePaged.D5bXF0nA.js";import{d as r,H as o,C as n,c as u,w as l,r as p,a as c,b as d,A as m,e as v,t as y,L as f,M as g,N as _,P as h}from"./index-Bpal6X9u.js";import{l as x}from"./activity-banner.C3kWKCRr.js";import{u as b}from"./useLocation.CgbsylOY.js";import"./wd-card.-vo_KsXs.js";import"./wd-divider.Cc4zUyyv.js";import"./PyText.vue_vue_type_script_setup_true_lang.1L9IIHvr.js";import"./wd-text.COOnfa1A.js";import"./PyTitle.Dn6RlDza.js";import"./index.DM5hYbMc.js";const w=r({__name:"index",setup(r){const w=o(),{update:j,longitude:L,latitude:P}=b();n(()=>{console.log("活动列表：",L.value,P.value)});const A=t=>({id:(null==t?void 0:t.id)||Date.now().toString(),img:null==t?void 0:t.picUrl,title:(null==t?void 0:t.name)||"未命名数根"}),S=t=>{const i=[];t.issueProduct&&(Array.isArray(t.issueProduct)?i.push(...t.issueProduct.map(t=>A(t))):i.push(A(t.issueProduct)));const a=[];var s;t.issueVoucher&&(Array.isArray(t.issueVoucher)?a.push(...t.issueVoucher.map(t=>A(t))):a.push({id:(null==(s=t.issueVoucher)?void 0:s.id)||Date.now().toString(),img:null==s?void 0:s.picUrl,title:(null==s?void 0:s.name)||"未命名权益"}));const e=[];return t.attendedUsers&&t.attendedUsers.forEach(t=>{e.push((t=>({avatar:null==t?void 0:t.avatar}))(t))}),{...t,pythrootList:i,profitList:a,participants:e}};const{list:U}=s(async function(t){const i="number"==typeof P.value?String(P.value):void 0,a="number"==typeof L.value?String(L.value):void 0;i&&a?j(!1):await j(!0);const s=await h.app.getActivityPage({params:{type:1,myLocationLatitude:i,myLocationLongitude:a,...t}}),{code:e,data:r}=s||{};if(0!==e||!r)throw new Error("获取数据失败");let o=r.list||[];return o=o.map(t=>S(t)),{list:o,total:r.total||0}});return(s,r)=>{const o=e,n=v,h=i,b=t,j=p("layout-tabbar-uni");return c(),u(j,null,{default:l(()=>[d(b,{"custom-class":"pb-228rpx bg-#EFF2F5","banner-height":"364rpx","banner-src":m(x)},{default:l(()=>[d(n,{class:"p-30rpx gap-20rpx mt-[-278rpx] flex flex-col bg-transparent"},{default:l(()=>[0===m(U).length?(c(),u(n,{key:0,class:"mt-260rpx"},{default:l(()=>[d(o)]),_:1})):y("",!0),(c(!0),f(g,null,_(m(U),t=>(c(),u(h,{key:t.id,"cover-img-src":t.picUrl||m(a),title:t.name,location:t.address||"","start-time":t.createTime,"end-time":t.endTime,participants:t.participants,"pythroot-list":t.pythrootList,"profit-list":t.profitList,distance:t.distance,"extra-button-text":"马上参与","time-status":t.timeStatus,onJoinNow:i=>{return a=t.id,void w.push({name:"activityDetail",params:{id:String(a)}});var a}},null,8,["cover-img-src","title","location","start-time","end-time","participants","pythroot-list","profit-list","distance","time-status","onJoinNow"]))),128))]),_:1})]),_:1},8,["banner-src"])]),_:1})}}});export{w as default};
