import{_ as e}from"./Descriptions.vue_vue_type_script_setup_true_lang.eL-2eRkO.js";import{_ as a}from"./wd-divider.DfAcvXdn.js";import{g as l,$ as s,m as t,f as c,d as u,l as o,C as r,a0 as n,o as d,p as i,q as p,be as h,c as m,a as f,e as v,n as _,h as x,w as y,b,j as w,t as g,v as k,x as C,y as V,z as j,A as D,a2 as $,_ as I,a_ as S,B as E,bf as F,r as O,N as z,O as A,Q as L,G as T,F as U,aO as Y,bg as M}from"./index-2e8oLCEa.js";import{_ as N}from"./PyTitle.Bls6GKJi.js";import{u as P,_ as W}from"./usePaged.DB3Cvfvs.js";import{_ as B,a as G}from"./wd-tab.D0rLXC7Q.js";import{f as q}from"./index.BS2-J1-k.js";import"./wd-col.BbuwICdw.js";const H=I(u({name:"wd-search",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...l,customInputClass:s(""),modelValue:s(""),useSuffixSlot:t(!1),placeholder:String,cancelTxt:String,light:t(!1),hideCancel:t(!1),disabled:t(!1),maxlength:c(-1),placeholderLeft:t(!1),focus:t(!1),focusWhenClear:t(!1),placeholderStyle:String,placeholderClass:s("")},emits:["update:modelValue","change","clear","search","focus","blur","cancel"],setup(e,{emit:a}){const l=e,s=a,{translate:t}=o("search"),c=r(!1),u=r(!1),I=r(""),S=r(!0),E=r(!1);n(()=>l.modelValue,e=>{I.value=e,e&&(u.value=!0)},{immediate:!0}),n(()=>l.focus,e=>{if(e){if(l.disabled)return;A()}}),d(()=>{l.focus&&A()});const F=i(()=>`wd-search  ${l.light?"is-light":""}  ${l.hideCancel?"is-without-cancel":""} ${l.customClass}`),O=i(()=>{const e={display:""===I.value&&S.value?"flex":"none"};return p(e)});async function z(e){u.value=e,await h(),c.value=e}async function A(){l.disabled||(await h(100),S.value=!1,z(!0))}function L(e){I.value=e.detail.value,s("update:modelValue",e.detail.value),s("change",{value:e.detail.value})}async function T(){I.value="",l.focusWhenClear&&(E.value=!0,c.value=!1),await h(),l.focusWhenClear?(S.value=!1,z(!0)):(S.value=!0,z(!1)),s("change",{value:""}),s("update:modelValue",""),s("clear")}function U({detail:{value:e}}){s("search",{value:e})}function Y(){S.value=!1,s("focus",{value:I.value})}async function M(){await h(150),E.value?E.value=!1:(S.value=!I.value,u.value=!S.value,c.value=!1,s("blur",{value:I.value}))}function N(){s("cancel",{value:I.value})}return(e,a)=>{const l=C,s=v,o=$;return f(),m(s,{class:x(F.value),style:_(e.customStyle)},{default:y(()=>[b(s,{class:"wd-search__block"},{default:y(()=>[w(e.$slots,"prefix",{},void 0,!0),b(s,{class:"wd-search__field"},{default:y(()=>[e.placeholderLeft?g("",!0):(f(),m(s,{key:0,style:_(O.value),class:"wd-search__cover",onClick:A},{default:y(()=>[b(k,{name:"search","custom-class":"wd-search__search-icon"}),b(l,{class:x(`wd-search__placeholder-txt ${e.placeholderClass}`)},{default:y(()=>[V(j(e.placeholder||D(t)("search")),1)]),_:1},8,["class"])]),_:1},8,["style"])),u.value||I.value||e.placeholderLeft?(f(),m(k,{key:1,name:"search","custom-class":"wd-search__search-left-icon"})):g("",!0),u.value||I.value||e.placeholderLeft?(f(),m(o,{key:2,placeholder:e.placeholder||D(t)("search"),"placeholder-class":`wd-search__placeholder-txt ${e.placeholderClass}`,"placeholder-style":e.placeholderStyle,"confirm-type":"search",modelValue:I.value,"onUpdate:modelValue":a[0]||(a[0]=e=>I.value=e),class:x(["wd-search__input",e.customInputClass]),onFocus:Y,onInput:L,onBlur:M,onConfirm:U,disabled:e.disabled,maxlength:e.maxlength,focus:c.value},null,8,["placeholder","placeholder-class","placeholder-style","modelValue","class","disabled","maxlength","focus"])):g("",!0),I.value?(f(),m(k,{key:3,"custom-class":"wd-search__clear wd-search__clear-icon",name:"error-fill",onClick:T})):g("",!0)]),_:1})]),_:3}),e.hideCancel?g("",!0):w(e.$slots,"suffix",{key:0},()=>[b(s,{class:"wd-search__cancel",onClick:N},{default:y(()=>[V(j(e.cancelTxt||D(t)("cancel")),1)]),_:1})],!0)]),_:3},8,["class","style"])}}}),[["__scopeId","data-v-7650d631"]]),Q=I(u({__name:"auth",setup(l){const s=[{key:"999",title:"全部"},{key:"1",title:"已授权"},{key:"0",title:"未授权"}],t=S({name:"",tab:"999"});const{list:c,reload:u}=P(async function(e){const a=await Y.app.getAppAuthPage({params:{...e,name:t.name||void 0,status:"999"===t.tab?void 0:Number(t.tab)}}),{code:l,data:s}=a||{};if(0!==l||!s)throw new Error("获取数据失败");return s}),o=M(u,600);n(()=>t.name,(e,a)=>{e!==a&&o()}),n(()=>t.tab,(e,a)=>{e!==a&&u()});const{confirm:r}=E(),{loading:d,close:i}=F();function p(e,a){if(!e)return;const l=0===a?1:0;r({title:"提示",msg:0===a?"确认要授权给该商户么？":"确认取消授权？取消后该商户无法再为您发放到场数字存根，可能会影响您后续相关权益领取。",success:async()=>{d("正在更新..."),await Y.app.updateAppAuthTenant({data:{id:e,status:l}});const a=c.value.findIndex(a=>a.id===e);-1!==a&&c.value.splice(a,1,{...c.value[a],status:l}),i()}})}return(l,u)=>{const o=H,r=G,n=B,d=v,i=W,h=T,_=N,x=U,w=a,k=e,C=O("layout-default-uni");return f(),m(C,null,{default:y(()=>[b(d,{class:"tenant-auth pt-54rpx pb-158rpx px-30rpx min-h-screen w-screen bg-white"},{default:y(()=>[b(d,null,{default:y(()=>[b(o,{"custom-class":"border-#DFE6ED border-solid border-2rpx rounded-100rpx",placeholder:"搜索授权商户",modelValue:D(t).name,"onUpdate:modelValue":u[0]||(u[0]=e=>D(t).name=e),"hide-cancel":""},null,8,["modelValue"]),b(n,{type:"long",modelValue:D(t).tab,"onUpdate:modelValue":u[1]||(u[1]=e=>D(t).tab=e),class:"mb-16rpx"},{default:y(()=>[(f(),z(A,null,L(s,e=>b(r,{key:e.key,title:`${e.title}`,name:e.key},null,8,["title","name"])),64))]),_:1},8,["modelValue"])]),_:1}),0===D(c).length?(f(),m(d,{key:0},{default:y(()=>[b(i)]),_:1})):g("",!0),(f(!0),z(A,null,L(D(c),e=>(f(),m(d,{key:e.id,class:"bg-#EFF2F5 rounded-18rpx py-30rpx px-34rpx mb-20rpx"},{default:y(()=>[b(d,{class:"gap-24rpx flex items-center"},{default:y(()=>[b(h,{"custom-class":"rounded-10rpx overflow-hidden flex-shrink-0",src:e.authObjectLogoUrl,width:"80rpx",height:"80rpx"},null,8,["src"]),b(_,{text:e.authObjectName,size:"36rpx","line-height":"54rpx"},null,8,["text"]),b(d,{class:"flex-grow"}),0===e.status?(f(),m(x,{key:0,"custom-class":"flex-shrink-0",size:"small",onClick:a=>p(e.id,e.status)},{default:y(()=>[V(" 去授权 ")]),_:2},1032,["onClick"])):g("",!0),1===e.status?(f(),m(x,{key:1,"custom-class":"flex-shrink-0",size:"small",type:"error",plain:"",onClick:a=>p(e.id,e.status)},{default:y(()=>[V(" 取消授权 ")]),_:2},1032,["onClick"])):g("",!0)]),_:2},1024),b(w,{class:"!my-20rpx !mx-0 !p-0",dashed:"",color:"#DFE6ED"}),b(k,{"value-color":"#333",data:[{label:"授权内容：",value:"到场证明"},{label:"授权时间：",value:D(q)(e.authTime,"YYYY年MM月DD日")},{label:"商户DID：",value:e.authObjectDid}]},null,8,["data"])]),_:2},1024))),128))]),_:1})]),_:1})}}}),[["__scopeId","data-v-9988d62d"]]);export{Q as default};
