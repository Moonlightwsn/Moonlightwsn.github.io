import{a4 as e,a5 as t,a6 as a,a7 as r,a8 as s,a9 as o,aa as n,ab as c,ac as i,ad as d,ae as l,af as u,ag as f,ah as m,ai as p,aj as x,ak as h,al as _,am as E,an as g,ao as v,ap as y,aq as S,ar as b,as as C,at as k,au as w,av as R,aw as U,ax as j,ay as T,az as N,aA as O,aB as A,aC as P,aD as F,aE as H,aF as K,aG as z,aH as D,aI as q,aJ as I,aK as W,d as L,H as Q,C as G,P as M,c as B,w as J,r as V,a as $,b as X,e as Y,v as Z,E as ee,A as te,N as ae,O as re,Q as se,t as oe,F as ne,y as ce,_ as ie}from"./index-DLEqDFWl.js";import{_ as de}from"./GradientText.vue_vue_type_script_setup_true_lang.7MJiORDR.js";import{_ as le}from"./PyTitle.DbeyPiIU.js";import{u as ue}from"./useRouteState.yPs3ogZU.js";import{u as fe}from"./usePageOptions.zFe1iZJE.js";import"./index.BwehUw5u.js";import"./_commonjsHelpers.lGe4XDVY.js";const me=(e,t)=>{let a=D;return function(...r){const s=e.bind(this,...r),o=j(t)?t:t(...r);a&&F(a),o>0?a=y(s,o):s()}};var pe,xe;(xe=pe||(pe={}))[xe.USE_REQUEST=1]="USE_REQUEST",xe[xe.USE_WATCHER=2]="USE_WATCHER",xe[xe.USE_FETCHER=3]="USE_FETCHER";const he=s("useRequest"),_e=s("useWatcher"),Ee=s("useFetcher"),ge=e=>({[pe.USE_REQUEST]:he,[pe.USE_WATCHER]:_e,[pe.USE_FETCHER]:Ee}[e]),ve="success",ye="error",Se="complete";class be{constructor(e,t){this.method=e,this.args=t}clone(){return{...this}}static spawn(e,t){return b(be,e,t)}}class Ce extends be{constructor(e,t,a){super(e.method,e.args),this.data=t,this.fromCache=a}}class ke extends be{constructor(e,t){super(e.method,e.args),this.error=t}}class we extends be{constructor(e,t,a,r,s){super(e.method,e.args),this.status=t,this.data=a,this.fromCache="error"!==t&&r,this.error=s}}const Re=(e,t)=>t(),Ue={};function je(a,s,n=[]){const d=ge(a.ht);let l=r(s,d,n);const{fs:m,ht:p,c:x}=a,{loading:h,data:_,error:g}=m,v=p===pe.USE_FETCHER,{force:y=t,middleware:C=Re}=x,k=o(l),{id:w}=k,R=c(l),{abortLast:U=e}=x,j=!a.m;return a.m=l,(async()=>{let r=K,o=t,c=N(u),k=K,T=K;const P=await O(l);let F=()=>!!P,D=t;v||(((e,t,a)=>{const r=Ue[e]=Ue[e]||{};r[t]||(r[t]=b(Set)),r[t].add(a)})(w,R,a),r=()=>((e,t,a)=>{const r=Ue[e],s=r[t];r&&s&&(a?s.delete(a):s.clear(),0===s.size&&z(r,t))})(w,R,a));const q=s=>{o=e;const{force:i=y,method:d=l}=s||{},u=f(i,[b(be,l,n)]),p=e=>({loaded:t,total:a})=>{m[e].v={loaded:t,total:a}};l=d,a.rf[R]=r,D||(h.v=!!u||!P);const{downloading:x,uploading:_}=a.ro.trackedKeys;return k=x?l.onDownload(p("downloading")):k,T=_?l.onUpload(p("uploading")):T,c=l.send(u),F=()=>l.fromCache||t,c},I={method:l,cachedResponse:P,config:x,abort:()=>l.abort()},W=()=>p!==pe.USE_WATCHER||!U||a.m===l,L=(a=e)=>{a&&j&&(h.v=t),D=a},Q=C(v?{...I,args:n,fetch:(e,...t)=>(((e,t)=>{e(i(t,H),"expected a method instance.")})(d,e),je(a,e,t)),proxyStates:A(m,"data"),controlLoading:L}:{...I,args:n,send:(...e)=>je(a,s,e),proxyStates:m,controlLoading:L},q);let G=u;const M=be.spawn(l,n);try{const e=await Q,r=e=>(v?a.c.updateState!==t&&E(((e,t)=>{const a=Ue[e]||{};return a[t]?Array.from(a[t]):[]})(w,R),t=>{t.fs.data.v=e}):W()&&(_.v=e),W()&&(g.v=u,!D&&(h.v=t),a.em.emit(ve,b(Ce,M,e,F())),a.em.emit(Se,b(we,M,ve,e,F(),u))),e);G=e!==u?r(e):o?await S(c,r,()=>r(u)):u,!o&&!D&&(h.v=t)}catch(B){throw W()&&(g.v=B,!D&&(h.v=t),a.em.emit(ye,b(ke,M,B)),a.em.emit(Se,b(we,M,ye,u,F(),B))),B}return k(),T(),G})()}const Te=e=>e.current;function Ne(s,N,O,A,F=t,H,D=0){var L;O={...O};let Q=!!F,G=u;if(F)try{const e=r(N,ge(s)),a=o(e),u=a.l1Cache.get(n(a.id,c(e)));if(u&&!i(u,d)){const[e,t]=u;(!t||t>l())&&(G=e)}Q=!!f(null!==(L=O.force)&&void 0!==L?L:t)||!G}catch(_e){}const{create:M,effectRequest:B,ref:J,objectify:V,exposeProvider:$,transformState2Proxy:X,__referingObj:Y}=function(r,s={trackedKeys:{},bindError:t,initialRequest:t,...m()}){const o=e=>r.ref?r.ref(e):{current:e};s=o(s).current;const n=e=>(r.export||q)(e,s),c=t=>{if(!x(r.memorize))return t;const a=r.memorize(t);return a.memorized=e,a},{dehydrate:d}=r,l=(e,t,a)=>e!==d(t,a,s)&&s.trackedKeys[a]&&r.update(e,t,a,s),u=e=>R(e,e=>i(e,U)?e.e:e),f=[],p={};return{create:(e,t)=>(w(f,t),b(C,r.create(e,t,s),t,e=>d(e,t,s),n,(e,a)=>l(a,e,t))),computed:(t,a,o)=>(E(a,t=>{t.k&&(p[t.k]=e)}),b(U,r.computed(t,u(a),o,s),o,e=>d(e,o,s),n)),effectRequest:e=>r.effectRequest(e,s),ref:o,watch:(e,t)=>r.watch(u(e),t,s),onMounted:e=>r.onMounted(e,s),onUnmounted:e=>r.onUnmounted(e,s),memorize:c,__referingObj:s,exposeProvider:r=>{const o={},n={},d=[];for(const t in r){const a=r[t];if(x(a)&&!s.trackedKeys[t])o[t]=t.startsWith("on")?(...e)=>(a(...e),g):a.memorized?a:c(a);else{k(["uploading","downloading"],t)||t.startsWith("__")||w(d,t);const r=i(a,U);r&&(n[t]=a.s),I.defineProperty(o,t,{get:()=>(s.trackedKeys[t]=e,r?a.e:a),set:K,enumerable:e,configurable:e})}}const{update:u,__proxyState:m}=o;s.trackedKeys={...p},s.bindError=t;const{then:h}=o,_={__referingObj:s,update:c(e=>{P(e).forEach(t=>{k(f,t)?l(e[t],n[t],t):t in o&&x(u)&&u({[t]:e[t]})})}),__proxyState:c(t=>k(f,t)&&i(r[t],U)?(s.trackedKeys[t]=e,r[t]):m(t)),then(t,a){E(d,t=>{s.trackedKeys[t]=e});const r=()=>{z(g,"then"),t(g)};x(h)?h(r,a):r()}},g=a(o,_);return g},objectify:(e,t)=>e.reduce((e,a)=>(e[a.k]=t?a[t]:a,e),{}),transformState2Proxy:(e,t)=>b(C,e,t,e=>d(e,t,s),n,(e,a)=>l(a,e,t))}}(p(),O.__referingObj),Z={total:0,loaded:0},{managedStates:ee={}}=O,te=((e,t)=>{const a={};for(const r in e)a[r]=t(e[r],r,e);return a})(ee,(e,t)=>X(e,t)),ae=M(null!=G?G:x(A)?A():A,"data"),re=M(Q,"loading"),se=M(u,"error"),oe=M({...Z},"downloading"),ne=M({...Z},"uploading"),ce=V([ae,re,se,oe,ne]),ie=h(),de=Te(J(((e,t,a,r)=>({m:u,rf:{},fs:{},em:a,ht:e,c:t,ro:r,ms:{}}))(s,O,ie,Y)));de.fs=ce,de.em=ie,de.c=O,de.ms={...ce,...te};const le=(e=N,t)=>je(de,e,t),ue=J(u),fe=J(t),pe=Te(J(_())),xe=(t=Y,a)=>{pe(()=>{T.ssr&&!Te(ue)||(Y.initialRequest=fe.current=e,S(le(a),()=>{var e;null===(e=Te(ue))||void 0===e||e.resolve()},e=>{var a;if(!t.bindError&&!t.trackedKeys.error&&!Te(ue))throw e;null===(a=Te(ue))||void 0===a||a.reject(e)}))})};J(me((e,t,a)=>xe(t,a),e=>j(e)?W(D)?D[e]:D:0)),B({handler:()=>xe(Y),removeStates:()=>{E(g(de.rf),e=>e())},frontStates:{...ce,...te},watchingStates:H,immediate:null!=F?F:e});const he=$({...V([ae,re,se,oe,ne]),abort:()=>de.m&&de.m.abort(),send:(e,t)=>le(t,e),onSuccess(e){ie.on(ve,e)},onError(t){Y.bindError=e,ie.on(ye,t)},onComplete(e){ie.on(Se,e)},then(e,t){const{promise:a,resolve:r,reject:s}=v();ue.current={resolve:r,reject:s},y(()=>{!fe.current&&r()},10),S(a,()=>{e(he)},t)}});return he}var Oe,Ae,Pe,Fe;(Ae=Oe||(Oe={}))[Ae.CONNECTING=0]="CONNECTING",Ae[Ae.OPEN=1]="OPEN",Ae[Ae.CLOSED=2]="CLOSED",(Fe=Pe||(Pe={})).Open="open",Fe.Error="error",Fe.Message="message",Fe.Close="close";const He=ie(L({__name:"result",setup(t){const r=Q(),s=ue(),o=G(),{data:n,send:c}=function(t,r={}){const{immediate:s=e,initialData:o}=r,n=Ne(pe.USE_REQUEST,t,r,o,!!s),{send:c}=n;return a(n,{send:(...e)=>c(e)})}(M.app.getActivity,{immediate:!1});function i(){r.replaceAll({name:"profit"})}return fe(async e=>{const{id:t,pageUUID:a}=e||{},r=Number.parseInt(t,10);t&&!Number.isNaN(r)&&(a&&(o.value=s.withdrawRouteState(a)),c({params:{id:r}}))}),(e,t)=>{const a=Z,s=le,c=ee,d=de,l=Y,u=ne,f=V("layout-default-uni");return $(),B(f,null,{default:J(()=>[X(l,{class:"p-64rpx bg-#f5f5f5 flex h-screen w-screen flex-col items-center justify-center"},{default:J(()=>[X(l,{class:"result-card bg-#fff rounded-24rpx py-64rpx px-32rpx gap-16rpx flex w-full flex-col items-center"},{default:J(()=>[X(a,{name:"check-outline",size:"148rpx",color:"#34d19d"}),X(l,{class:"gap-2rpx flex flex-col items-center"},{default:J(()=>{var e,t;return[X(s,{text:"恭喜您！"}),X(c,{text:`已成功参加“${(null==(t=null==(e=te(n))?void 0:e.data)?void 0:t.name)||""}”活动`},null,8,["text"]),X(l,{class:"gap-4rpx mt-4rpx flex flex-col"},{default:J(()=>{var e;return[($(!0),ae(re,null,se(((null==(e=te(o))?void 0:e.succeedProducts)||[]).filter(e=>e.id&&2===Number(e.productSpuType)),e=>($(),B(l,{key:e.id,class:"bg-#FF6A001A rounded-96rpx py-4rpx px-12rpx",onClick:t=>{return a=e.id,void r.push({name:"profitDetail",params:{id:String(a)}});var a}},{default:J(()=>[X(d,{"custom-class":"text-24rpx leading-28rpx",text:e.productSpuName},null,8,["text"])]),_:2},1032,["onClick"]))),128))]}),_:1})]}),_:1}),X(l,{class:"gap-24rpx px-24rpx mt-48rpx flex w-full flex-col"},{default:J(()=>{var e,t;return[((null==(t=null==(e=te(n))?void 0:e.data)?void 0:t.issueVoucher)||[]).length>0?($(),B(u,{key:0,block:"",onClick:i},{default:J(()=>[ce(" 查看我的权益 ")]),_:1})):oe("",!0),X(u,{block:"",plain:"",onClick:te(r).back},{default:J(()=>[ce("返回活动详情")]),_:1},8,["onClick"])]}),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-54ec4f5d"]]);export{He as default};
