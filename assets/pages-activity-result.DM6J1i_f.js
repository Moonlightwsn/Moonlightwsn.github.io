import{a8 as e,a9 as t,aa as a,ab as r,ac as s,ad as o,ae as n,af as c,ag as l,ah as i,ai as d,aj as u,ak as f,al as p,am as m,an as x,ao as h,ap as _,aq as g,ar as v,as as E,at as b,au as y,av as S,aw as w,ax as k,ay as C,az as U,aA as R,aB as T,aC as j,aD as N,aE as O,aF as z,aG as A,aH as P,aI as K,aJ as H,aK as F,aL as D,aM as q,aN as I,aO as W,d as L,H as Q,D as G,P as M,Q as B,c as J,w as V,r as X,M as $,F as Y,R as Z,a as ee,b as te,e as ae,x as re,I as se,B as oe,S as ne,T as ce,U as le,v as ie,J as de,z as ue,X as fe,aP as pe,K as me,aQ as xe,_ as he}from"./index-BoOjZWLk.js";import{_ as _e}from"./GradientText.vue_vue_type_script_setup_true_lang.DcaAfEFi.js";import{_ as ge}from"./PyTitle.CZQNf9rT.js";import{u as ve}from"./useRouteState.BVjNhLl-.js";import{u as Ee}from"./usePageOptions.BUijDlU9.js";const be=(e,t)=>{let a=D;return function(...r){const s=e.bind(this,...r),o=T(t)?t:t(...r);a&&P(a),o>0?a=b(s,o):s()}};var ye,Se;(Se=ye||(ye={}))[Se.USE_REQUEST=1]="USE_REQUEST",Se[Se.USE_WATCHER=2]="USE_WATCHER",Se[Se.USE_FETCHER=3]="USE_FETCHER";const we=s("useRequest"),ke=s("useWatcher"),Ce=s("useFetcher"),Ue=e=>({[ye.USE_REQUEST]:we,[ye.USE_WATCHER]:ke,[ye.USE_FETCHER]:Ce}[e]),Re="success",Te="error",je="complete";class Ne{constructor(e,t){this.method=e,this.args=t}clone(){return{...this}}static spawn(e,t){return S(Ne,e,t)}}class Oe extends Ne{constructor(e,t,a){super(e.method,e.args),this.data=t,this.fromCache=a}}class ze extends Ne{constructor(e,t){super(e.method,e.args),this.error=t}}class Ae extends Ne{constructor(e,t,a,r,s){super(e.method,e.args),this.status=t,this.data=a,this.fromCache="error"!==t&&r,this.error=s}}const Pe=(e,t)=>t(),Ke={};function He(a,s,n=[]){const i=Ue(a.ht);let d=r(s,i,n);const{fs:p,ht:m,c:x}=a,{loading:h,data:_,error:v}=p,E=m===ye.USE_FETCHER,{force:b=t,middleware:w=Pe}=x,k=o(d),{id:C}=k,U=c(d),{abortLast:R=e}=x,T=!a.m;return a.m=d,(async()=>{let r=H,o=t,c=N(u),k=H,j=H;const A=await O(d);let P=()=>!!A,D=t;E||(((e,t,a)=>{const r=Ke[e]=Ke[e]||{};r[t]||(r[t]=S(Set)),r[t].add(a)})(C,U,a),r=()=>((e,t,a)=>{const r=Ke[e],s=r[t];r&&s&&(a?s.delete(a):s.clear(),0===s.size&&F(r,t))})(C,U,a));const q=s=>{o=e;const{force:l=b,method:i=d}=s||{},u=f(l,[S(Ne,d,n)]),m=e=>({loaded:t,total:a})=>{p[e].v={loaded:t,total:a}};d=i,a.rf[U]=r,D||(h.v=!!u||!A);const{downloading:x,uploading:_}=a.ro.trackedKeys;return k=x?d.onDownload(m("downloading")):k,j=_?d.onUpload(m("uploading")):j,c=d.send(u),P=()=>d.fromCache||t,c},I={method:d,cachedResponse:A,config:x,abort:()=>d.abort()},W=()=>m!==ye.USE_WATCHER||!R||a.m===d,L=(a=e)=>{a&&T&&(h.v=t),D=a},Q=w(E?{...I,args:n,fetch:(e,...t)=>(((e,t)=>{e(l(t,K),"expected a method instance.")})(i,e),He(a,e,t)),proxyStates:z(p,"data"),controlLoading:L}:{...I,args:n,send:(...e)=>He(a,s,e),proxyStates:p,controlLoading:L},q);let G=u;const M=Ne.spawn(d,n);try{const e=await Q,r=e=>(E?a.c.updateState!==t&&g(((e,t)=>{const a=Ke[e]||{};return a[t]?Array.from(a[t]):[]})(C,U),t=>{t.fs.data.v=e}):W()&&(_.v=e),W()&&(v.v=u,!D&&(h.v=t),a.em.emit(Re,S(Oe,M,e,P())),a.em.emit(je,S(Ae,M,Re,e,P(),u))),e);G=e!==u?r(e):o?await y(c,r,()=>r(u)):u,!o&&!D&&(h.v=t)}catch(B){throw W()&&(v.v=B,!D&&(h.v=t),a.em.emit(Te,S(ze,M,B)),a.em.emit(je,S(Ae,M,Te,u,P(),B))),B}return k(),j(),G})()}const Fe=e=>e.current;function De(s,N,O,z,P=t,K,D=0){var L;O={...O};let Q=!!P,G=u;if(P)try{const e=r(N,Ue(s)),a=o(e),u=a.l1Cache.get(n(a.id,c(e)));if(u&&!l(u,i)){const[e,t]=u;(!t||t>d())&&(G=e)}Q=!!f(null!==(L=O.force)&&void 0!==L?L:t)||!G}catch(he){}const{create:M,effectRequest:B,ref:J,objectify:V,exposeProvider:X,transformState2Proxy:$,__referingObj:Y}=function(r,s={trackedKeys:{},bindError:t,initialRequest:t,...p()}){const o=e=>r.ref?r.ref(e):{current:e};s=o(s).current;const n=e=>(r.export||q)(e,s),c=t=>{if(!x(r.memorize))return t;const a=r.memorize(t);return a.memorized=e,a},{dehydrate:i}=r,d=(e,t,a)=>e!==i(t,a,s)&&s.trackedKeys[a]&&r.update(e,t,a,s),u=e=>U(e,e=>l(e,R)?e.e:e),f=[],m={};return{create:(e,t)=>(C(f,t),S(w,r.create(e,t,s),t,e=>i(e,t,s),n,(e,a)=>d(a,e,t))),computed:(t,a,o)=>(g(a,t=>{t.k&&(m[t.k]=e)}),S(R,r.computed(t,u(a),o,s),o,e=>i(e,o,s),n)),effectRequest:e=>r.effectRequest(e,s),ref:o,watch:(e,t)=>r.watch(u(e),t,s),onMounted:e=>r.onMounted(e,s),onUnmounted:e=>r.onUnmounted(e,s),memorize:c,__referingObj:s,exposeProvider:r=>{const o={},n={},i=[];for(const t in r){const a=r[t];if(x(a)&&!s.trackedKeys[t])o[t]=t.startsWith("on")?(...e)=>(a(...e),v):a.memorized?a:c(a);else{k(["uploading","downloading"],t)||t.startsWith("__")||C(i,t);const r=l(a,R);r&&(n[t]=a.s),I.defineProperty(o,t,{get:()=>(s.trackedKeys[t]=e,r?a.e:a),set:H,enumerable:e,configurable:e})}}const{update:u,__proxyState:p}=o;s.trackedKeys={...m},s.bindError=t;const{then:h}=o,_={__referingObj:s,update:c(e=>{A(e).forEach(t=>{k(f,t)?d(e[t],n[t],t):t in o&&x(u)&&u({[t]:e[t]})})}),__proxyState:c(t=>k(f,t)&&l(r[t],R)?(s.trackedKeys[t]=e,r[t]):p(t)),then(t,a){g(i,t=>{s.trackedKeys[t]=e});const r=()=>{F(v,"then"),t(v)};x(h)?h(r,a):r()}},v=a(o,_);return v},objectify:(e,t)=>e.reduce((e,a)=>(e[a.k]=t?a[t]:a,e),{}),transformState2Proxy:(e,t)=>S(w,e,t,e=>i(e,t,s),n,(e,a)=>d(a,e,t))}}(m(),O.__referingObj),Z={total:0,loaded:0},{managedStates:ee={}}=O,te=((e,t)=>{const a={};for(const r in e)a[r]=t(e[r],r,e);return a})(ee,(e,t)=>$(e,t)),ae=M(null!=G?G:x(z)?z():z,"data"),re=M(Q,"loading"),se=M(u,"error"),oe=M({...Z},"downloading"),ne=M({...Z},"uploading"),ce=V([ae,re,se,oe,ne]),le=h(),ie=Fe(J(((e,t,a,r)=>({m:u,rf:{},fs:{},em:a,ht:e,c:t,ro:r,ms:{}}))(s,O,le,Y)));ie.fs=ce,ie.em=le,ie.c=O,ie.ms={...ce,...te};const de=(e=N,t)=>He(ie,e,t),ue=J(u),fe=J(t),pe=Fe(J(_())),me=(t=Y,a)=>{pe(()=>{j.ssr&&!Fe(ue)||(Y.initialRequest=fe.current=e,y(de(a),()=>{var e;null===(e=Fe(ue))||void 0===e||e.resolve()},e=>{var a;if(!t.bindError&&!t.trackedKeys.error&&!Fe(ue))throw e;null===(a=Fe(ue))||void 0===a||a.reject(e)}))})};J(be((e,t,a)=>me(t,a),e=>T(e)?W(D)?D[e]:D:0)),B({handler:()=>me(Y),removeStates:()=>{g(v(ie.rf),e=>e())},frontStates:{...ce,...te},watchingStates:K,immediate:null!=P?P:e});const xe=X({...V([ae,re,se,oe,ne]),abort:()=>ie.m&&ie.m.abort(),send:(e,t)=>de(t,e),onSuccess(e){le.on(Re,e)},onError(t){Y.bindError=e,le.on(Te,t)},onComplete(e){le.on(je,e)},then(e,t){const{promise:a,resolve:r,reject:s}=E();ue.current={resolve:r,reject:s},b(()=>{!fe.current&&r()},10),y(a,()=>{e(xe)},t)}});return xe}var qe,Ie,We,Le;(Ie=qe||(qe={}))[Ie.CONNECTING=0]="CONNECTING",Ie[Ie.OPEN=1]="OPEN",Ie[Ie.CLOSED=2]="CLOSED",(Le=We||(We={})).Open="open",Le.Error="error",Le.Message="message",Le.Close="close";const Qe=he(L({__name:"result",setup(t){const r=Q(),s=ve(),o=G(),{data:n,send:c}=function(t,r={}){const{immediate:s=e,initialData:o}=r,n=De(ye.USE_REQUEST,t,r,o,!!s),{send:c}=n;return a(n,{send:(...e)=>c(e)})}(M.app.getActivity,{immediate:!1});function l(){r.replaceAll({name:"profit"})}const i=G(!1);Ee(async e=>{const{id:t,pageUUID:a}=e||{},r=Number.parseInt(t,10);t&&!Number.isNaN(r)&&(a&&(o.value=s.withdrawRouteState(a)),$()&&(i.value=!0,Y({icon:"error",title:"权益马上将由短信方式递送给您，或保存数根官网扫码进入查看",duration:5e3})),c({params:{id:r}}))});const d=G(),u=G(0),f=G([0]);function p(){"number"==typeof d.value&&(u.value=d.value)}function m(){u.value=0}function x(){($()||/micromessenger/i.test(window.navigator.userAgent))&&Y({icon:"error",title:"微信内可以长按二维码来保存图片哦！",duration:6e3});const e=document.createElement("a");e.download="场印.png",e.href=xe,document.body.append(e),e.click(),e.remove()}return B(()=>{const e=Z().windowHeight;d.value=1*e,f.value=[0,d.value]}),(e,t)=>{const a=re,s=ge,c=se,d=_e,h=ae,_=de,g=me,v=fe,E=X("layout-default-uni");return ee(),J(E,null,{default:V(()=>[te(h,{class:"p-64rpx bg-#f5f5f5 flex h-screen w-screen flex-col items-center justify-center"},{default:V(()=>[te(h,{class:"result-card bg-#fff rounded-24rpx py-64rpx px-32rpx gap-16rpx flex w-full flex-col items-center"},{default:V(()=>[te(a,{name:"check-outline",size:"148rpx",color:"#34d19d"}),te(h,{class:"gap-2rpx flex flex-col items-center"},{default:V(()=>{var e,t;return[te(s,{text:"恭喜您！"}),te(c,{text:`已成功参加“${(null==(t=null==(e=oe(n))?void 0:e.data)?void 0:t.name)||""}”活动`},null,8,["text"]),te(h,{class:"gap-4rpx mt-4rpx flex flex-col"},{default:V(()=>{var e;return[(ee(!0),ne(ce,null,le(((null==(e=oe(o))?void 0:e.succeedProducts)||[]).filter(e=>e.id&&2===Number(e.productSpuType)),e=>(ee(),J(h,{key:e.id,class:"bg-#FF6A001A rounded-96rpx py-4rpx px-12rpx",onClick:t=>{return a=e.id,void r.push({name:"profitDetail",params:{id:String(a)}});var a}},{default:V(()=>[te(d,{"custom-class":"text-24rpx leading-28rpx",text:e.productSpuName},null,8,["text"])]),_:2},1032,["onClick"]))),128))]}),_:1})]}),_:1}),te(h,{class:"gap-24rpx px-24rpx mt-48rpx flex w-full flex-col"},{default:V(()=>{var e,t;return[!oe(i)&&((null==(t=null==(e=oe(n))?void 0:e.data)?void 0:t.issueVoucher)||[]).length>0?(ee(),J(_,{key:0,block:"",onClick:l},{default:V(()=>[ue(" 查看我的权益 ")]),_:1})):ie("",!0),te(_,{block:"",plain:"",onClick:oe(r).back},{default:V(()=>[ue("返回活动详情")]),_:1},8,["onClick"])]}),_:1}),te(h,{class:"mt-24rpx"},{default:V(()=>[te(h,{class:"text-24rpx text-#545454"},{default:V(()=>[ue(" 提示：为方便下次使用，请及时 "),te(c,{"custom-class":"mx-4rpx",text:"[点我保存]",color:"var(--wot-color-theme)",onClick:p}),ue(" 网站 ")]),_:1})]),_:1})]),_:1}),te(v,{"custom-class":"!z-999 bg-black rounded-none",height:oe(u),"onUpdate:height":t[0]||(t[0]=e=>pe(u)?u.value=e:null),anchors:oe(f),"safe-area-inset-bottom":""},{default:V(()=>[te(h,{class:"gap-24rpx relative flex h-full w-full flex-col items-center"},{default:V(()=>[te(h,{class:"h-1062rpx w-750rpx relative"},{default:V(()=>[te(g,{src:oe(xe),width:"100%",height:"100%"},null,8,["src"]),te(h,{class:"top-18rpx min-w-560rpx border-2rpx border-#ffffff66 rounded-32rpx py-4rpx px-24rpx bg-[rgba(241, 249, 255, 0.05)] absolute left-1/2 translate-x-[-50%] shadow-[0_4px_24rpx_0_rgba(0,0,0,0.08)]"},{default:V(()=>[te(c,{"custom-class":" text-center ",text:"手机截图保存本页面，或点击“保存至相册”",size:"26rpx"})]),_:1})]),_:1}),te(h,{class:"gap-24rpx bottom-24rpx sticky flex"},{default:V(()=>[te(_,{onClick:x},{default:V(()=>[ue("保存至相册")]),_:1}),te(_,{type:"info",onClick:m},{default:V(()=>[ue(" 取消 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["height","anchors"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-ccf252bc"]]);export{Qe as default};
