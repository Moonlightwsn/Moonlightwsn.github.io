import{d as e,bD as a,bE as l,H as t,B as s,b0 as o,c as r,w as n,r as i,a as u,b as d,A as c,e as m,b1 as p,D as f,y as _,bF as x,C as b,_ as v}from"./index-a6TtsOgc.js";import{_ as g}from"./BannerView.vue_vue_type_script_setup_true_lang.BEJtDK2a.js";import{_ as y}from"./PyText.vue_vue_type_script_setup_true_lang.C4vd1DLX.js";import{_ as w}from"./wd-form.CexgOjdO.js";import{l as h}from"./pythroot-banner.02EEHkli.js";import{_ as V}from"./SmsCodeBtn.vue_vue_type_script_setup_true_lang.CmoOi_Li.js";import"./wd-text.O2Z1f8vu.js";const j=v(e({__name:"index",setup(e){const v=a(),j=l("tenant_id",""),k=t(),I=s(),z=o({code:"",mobile:""}),C=s(!1);async function T(){return await I.value.validate()}async function q(){var e,a;if(C.value)return;const{valid:l}=await I.value.validate();if(l)try{C.value=!0;const l=await x.general.smsLogin({data:{...z,templateIdList:[1,2]}});if((null==(e=null==l?void 0:l.data)?void 0:e.accessToken)&&(null==(a=null==l?void 0:l.data)?void 0:a.tenantId)){const{accessToken:e,tenantId:a}=l.data;v.value=e,j.value=a,b({icon:"success",title:"登录成功",success(){setTimeout(()=>{k.replaceAll({name:"merchantProfile"})},1e3)}})}else b({icon:"error",title:(null==l?void 0:l.msg)||"登录失败"})}finally{C.value=!1}}const B=/^\d{11}$/;function P(e){return!(z.mobile&&B.test(z.mobile)&&!e)}return(e,a)=>{const l=p,t=f,s=w,o=m,x=y,b=g,v=i("layout-default-uni");return u(),r(v,null,{default:n(()=>[d(b,{fixed:!1,"custom-class":"bg-white login-page","banner-src":c(h),"banner-height":"364rpx"},{default:n(()=>[d(o,{class:"py-60rpx px-56rpx flex h-full flex-grow flex-col"},{default:n(()=>[d(s,{ref_key:"form",ref:I,"custom-class":"gap-16rpx flex flex-col",model:c(z)},{default:n(()=>[d(l,{modelValue:c(z).mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>c(z).mobile=e),prop:"mobile",rules:[{required:!0,message:"请输入手机号"},{required:!1,pattern:B,message:"手机号格式不正确"}],"custom-class":"rounded-10rpx px-28rpx","no-border":"",type:"digit","input-mode":"numeric",placeholder:"请输入手机号"},null,8,["modelValue","rules"]),d(l,{modelValue:c(z).code,"onUpdate:modelValue":a[1]||(a[1]=e=>c(z).code=e),prop:"code",rules:[{required:!1,validator:P,message:"请输入验证码"}],"custom-class":"rounded-10rpx px-28rpx","no-border":"",type:"text","input-mode":"text",placeholder:"请输入验证码"},{suffix:n(()=>[d(V,{mobile:c(z).mobile,"is-admin":!0,onValidate:T},null,8,["mobile"])]),_:1},8,["modelValue","rules"]),d(t,{type:"primary",block:"",size:"large",round:!1,disabled:c(C),onClick:q},{default:n(()=>[_(" 登录 ")]),_:1},8,["disabled"])]),_:1},8,["model"]),d(o,{class:"flex-grow"}),d(o,{class:"flex flex-col items-center"},{default:n(()=>[d(x,{text:"浦江数链提供技术支持",color:"#999",size:"24rpx"}),d(x,{text:"沪ICP备2023032312号-2",color:"#999",size:"24rpx"})]),_:1})]),_:1})]),_:1},8,["banner-src"])]),_:1})}}}),[["__scopeId","data-v-b2c26e63"]]);export{j as default};
