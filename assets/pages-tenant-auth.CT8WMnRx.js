import{_ as e}from"./Descriptions.vue_vue_type_script_setup_true_lang.CFQOq7FE.js";import{_ as a}from"./wd-divider.Cc4zUyyv.js";import{g as l,O as s,m as t,f as u,d as c,l as o,B as r,Q as n,o as d,p as i,q as p,ao as h,c as m,a as f,e as v,n as _,h as y,w as x,b,j as w,t as g,v as k,x as C,y as j,z as V,A as D,S,_ as E,a6 as F,a8 as I,ap as $,r as A,L,M as T,N as z,F as O,E as P,Y as U,aq as B}from"./index-Bpal6X9u.js";import{_ as N}from"./PyTitle.Dn6RlDza.js";import{u as W,_ as q}from"./usePaged.D5bXF0nA.js";import{_ as G,a as M}from"./wd-tab.qIZ6aAd6.js";import{a as H}from"./index.DM5hYbMc.js";import"./wd-col.BoohVz6c.js";import"./PyText.vue_vue_type_script_setup_true_lang.1L9IIHvr.js";import"./wd-text.COOnfa1A.js";const K=E(c({name:"wd-search",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...l,customInputClass:s(""),modelValue:s(""),useSuffixSlot:t(!1),placeholder:String,cancelTxt:String,light:t(!1),hideCancel:t(!1),disabled:t(!1),maxlength:u(-1),placeholderLeft:t(!1),focus:t(!1),focusWhenClear:t(!1),placeholderStyle:String,placeholderClass:s("")},emits:["update:modelValue","change","clear","search","focus","blur","cancel"],setup(e,{emit:a}){const l=e,s=a,{translate:t}=o("search"),u=r(!1),c=r(!1),E=r(""),F=r(!0),I=r(!1);n(()=>l.modelValue,e=>{E.value=e,e&&(c.value=!0)},{immediate:!0}),n(()=>l.focus,e=>{if(e){if(l.disabled)return;T()}}),d(()=>{l.focus&&T()});const $=i(()=>`wd-search  ${l.light?"is-light":""}  ${l.hideCancel?"is-without-cancel":""} ${l.customClass}`),A=i(()=>{const e={display:""===E.value&&F.value?"flex":"none"};return p(e)});async function L(e){c.value=e,await h(),u.value=e}async function T(){l.disabled||(await h(100),F.value=!1,L(!0))}function z(e){E.value=e.detail.value,s("update:modelValue",e.detail.value),s("change",{value:e.detail.value})}async function O(){E.value="",l.focusWhenClear&&(I.value=!0,u.value=!1),await h(),l.focusWhenClear?(F.value=!1,L(!0)):(F.value=!0,L(!1)),s("change",{value:""}),s("update:modelValue",""),s("clear")}function P({detail:{value:e}}){s("search",{value:e})}function U(){F.value=!1,s("focus",{value:E.value})}async function B(){await h(150),I.value?I.value=!1:(F.value=!E.value,c.value=!F.value,u.value=!1,s("blur",{value:E.value}))}function N(){s("cancel",{value:E.value})}return(e,a)=>{const l=C,s=v,o=S;return f(),m(s,{class:y($.value),style:_(e.customStyle)},{default:x(()=>[b(s,{class:"wd-search__block"},{default:x(()=>[w(e.$slots,"prefix",{},void 0,!0),b(s,{class:"wd-search__field"},{default:x(()=>[e.placeholderLeft?g("",!0):(f(),m(s,{key:0,style:_(A.value),class:"wd-search__cover",onClick:T},{default:x(()=>[b(k,{name:"search","custom-class":"wd-search__search-icon"}),b(l,{class:y(`wd-search__placeholder-txt ${e.placeholderClass}`)},{default:x(()=>[j(V(e.placeholder||D(t)("search")),1)]),_:1},8,["class"])]),_:1},8,["style"])),c.value||E.value||e.placeholderLeft?(f(),m(k,{key:1,name:"search","custom-class":"wd-search__search-left-icon"})):g("",!0),c.value||E.value||e.placeholderLeft?(f(),m(o,{key:2,placeholder:e.placeholder||D(t)("search"),"placeholder-class":`wd-search__placeholder-txt ${e.placeholderClass}`,"placeholder-style":e.placeholderStyle,"confirm-type":"search",modelValue:E.value,"onUpdate:modelValue":a[0]||(a[0]=e=>E.value=e),class:y(["wd-search__input",e.customInputClass]),onFocus:U,onInput:z,onBlur:B,onConfirm:P,disabled:e.disabled,maxlength:e.maxlength,focus:u.value},null,8,["placeholder","placeholder-class","placeholder-style","modelValue","class","disabled","maxlength","focus"])):g("",!0),E.value?(f(),m(k,{key:3,"custom-class":"wd-search__clear wd-search__clear-icon",name:"error-fill",onClick:O})):g("",!0)]),_:1})]),_:3}),e.hideCancel?g("",!0):w(e.$slots,"suffix",{key:0},()=>[b(s,{class:"wd-search__cancel",onClick:N},{default:x(()=>[j(V(e.cancelTxt||D(t)("cancel")),1)]),_:1})],!0)]),_:3},8,["class","style"])}}}),[["__scopeId","data-v-7650d631"]]),Q=E(c({__name:"auth",setup(l){const s=[{key:"999",title:"全部"},{key:"1",title:"已授权"},{key:"0",title:"未授权"}],t=F({name:"",tab:"999"});const{list:u,reload:c}=W(async function(e){const a=await U.app.getAppAuthPage({params:{...e,name:t.name||void 0,status:"999"===t.tab?void 0:Number(t.tab)}}),{code:l,data:s}=a||{};if(0!==l||!s)throw new Error("获取数据失败");return s}),o=B(c,600);n(()=>t.name,(e,a)=>{e!==a&&o()}),n(()=>t.tab,(e,a)=>{e!==a&&c()});const{confirm:r}=I(),{loading:d,close:i}=$();function p(e,a){if(!e)return;const l=0===a?1:0;r({title:"提示",msg:0===a?"确认要授权给该商户么？":"确认要取消对该商户的授权么？",success:async()=>{d("正在更新..."),await U.app.updateAppAuthTenant({data:{id:e,status:l}});const a=u.value.findIndex(a=>a.id===e);-1!==a&&u.value.splice(a,1,{...u.value[a],status:l}),i()}})}return(l,c)=>{const o=K,r=M,n=G,d=v,i=q,h=O,_=N,y=P,w=a,k=e,C=A("layout-default-uni");return f(),m(C,null,{default:x(()=>[b(d,{class:"tenant-auth pt-54rpx px-30rpx min-h-screen w-screen bg-white"},{default:x(()=>[b(d,null,{default:x(()=>[b(o,{"custom-class":"border-#DFE6ED border-solid border-2rpx rounded-100rpx",placeholder:"搜索授权商户",modelValue:D(t).name,"onUpdate:modelValue":c[0]||(c[0]=e=>D(t).name=e),"hide-cancel":""},null,8,["modelValue"]),b(n,{type:"long",modelValue:D(t).tab,"onUpdate:modelValue":c[1]||(c[1]=e=>D(t).tab=e),class:"mb-16rpx"},{default:x(()=>[(f(),L(T,null,z(s,e=>b(r,{key:e.key,title:`${e.title}`,name:e.key},null,8,["title","name"])),64))]),_:1},8,["modelValue"])]),_:1}),0===D(u).length?(f(),m(d,{key:0},{default:x(()=>[b(i)]),_:1})):g("",!0),(f(!0),L(T,null,z(D(u),e=>(f(),m(d,{key:e.id,class:"bg-#EFF2F5 rounded-18rpx py-30rpx px-34rpx mb-20rpx"},{default:x(()=>[b(d,{class:"gap-24rpx flex items-center"},{default:x(()=>[b(h,{"custom-class":"rounded-10rpx overflow-hidden",src:e.authObjectLogoUrl,width:"80rpx",height:"80rpx"},null,8,["src"]),b(_,{text:e.authObjectName,size:"36rpx","line-height":"54rpx"},null,8,["text"]),b(d,{class:"flex-grow"}),0===e.status?(f(),m(y,{key:0,size:"small",onClick:a=>p(e.id,e.status)},{default:x(()=>[j(" 去授权 ")]),_:2},1032,["onClick"])):g("",!0),1===e.status?(f(),m(y,{key:1,size:"small",type:"error",plain:"",onClick:a=>p(e.id,e.status)},{default:x(()=>[j(" 取消授权 ")]),_:2},1032,["onClick"])):g("",!0)]),_:2},1024),b(w,{class:"!my-20rpx !mx-0 !p-0",dashed:"",color:"#DFE6ED"}),b(k,{"value-color":"#333",data:[{label:"授权内容：",value:"DAO场证明"},{label:"授权时间：",value:D(H)(e.authTime)},{label:"商户DID：",value:e.authObjectDid}]},null,8,["data"])]),_:2},1024))),128))]),_:1})]),_:1})}}}),[["__scopeId","data-v-01f552ac"]]);export{Q as default};
