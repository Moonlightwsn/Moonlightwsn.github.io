import{d as e,aS as a,aT as l,H as s,B as t,a8 as o,c as r,w as n,r as i,a as u,b as d,A as c,e as m,a9 as p,F as f,y as x,E as _,aU as b,D as v,_ as g}from"./index-Bly4hIk5.js";import{_ as y}from"./BannerView.vue_vue_type_script_setup_true_lang.B55NZ1Jk.js";import{_ as w}from"./wd-form.m4Qmq51s.js";import{l as h}from"./pythroot-banner.WDKHhXnh.js";import{_ as V}from"./SmsCodeBtn.vue_vue_type_script_setup_true_lang.B9Rt-cXV.js";const j=g(e({__name:"index",setup(e){const g=a(),j=l("tenant_id",""),k=s(),I=t(),T=o({code:"",mobile:""}),q=t(!1);async function z(){return await I.value.validate()}async function B(){var e,a;if(q.value)return;const{valid:l}=await I.value.validate();if(l)try{q.value=!0;const l=await b.general.smsLogin({data:{...T,templateIdList:[1,2]}});if((null==(e=null==l?void 0:l.data)?void 0:e.accessToken)&&(null==(a=null==l?void 0:l.data)?void 0:a.tenantId)){const{accessToken:e,tenantId:a}=l.data;g.value=e,j.value=a,v({icon:"success",title:"登录成功",success(){setTimeout(()=>{k.replaceAll({name:"merchantProfile"})},1e3)}})}else v({icon:"error",title:(null==l?void 0:l.msg)||"登录失败"})}finally{q.value=!1}}const C=/^\d{11}$/;function P(e){return!(T.mobile&&C.test(T.mobile)&&!e)}return(e,a)=>{const l=p,s=f,t=w,o=m,b=_,v=y,g=i("layout-default-uni");return u(),r(g,null,{default:n(()=>[d(v,{fixed:!1,"custom-class":"bg-white login-page","banner-src":c(h),"banner-height":"364rpx"},{default:n(()=>[d(o,{class:"py-60rpx px-56rpx flex h-full flex-grow flex-col"},{default:n(()=>[d(t,{ref_key:"form",ref:I,"custom-class":"gap-16rpx flex flex-col",model:c(T)},{default:n(()=>[d(l,{modelValue:c(T).mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>c(T).mobile=e),prop:"mobile",rules:[{required:!0,message:"请输入手机号"},{required:!1,pattern:C,message:"手机号格式不正确"}],"custom-class":"rounded-10rpx px-28rpx","no-border":"",type:"digit","input-mode":"numeric",placeholder:"请输入手机号"},null,8,["modelValue","rules"]),d(l,{modelValue:c(T).code,"onUpdate:modelValue":a[1]||(a[1]=e=>c(T).code=e),prop:"code",rules:[{required:!1,validator:P,message:"请输入验证码"}],"custom-class":"rounded-10rpx px-28rpx","no-border":"",type:"text","input-mode":"text",placeholder:"请输入验证码"},{suffix:n(()=>[d(V,{mobile:c(T).mobile,"is-admin":!0,onValidate:z},null,8,["mobile"])]),_:1},8,["modelValue","rules"]),d(s,{type:"primary",block:"",size:"large",round:!1,disabled:c(q),onClick:B},{default:n(()=>[x(" 登录 ")]),_:1},8,["disabled"])]),_:1},8,["model"]),d(o,{class:"flex-grow"}),d(o,{class:"flex flex-col items-center"},{default:n(()=>[d(b,{text:"浦江数链提供技术支持",color:"#999",size:"24rpx"}),d(b,{text:"沪ICP备2023032312号-1",color:"#999",size:"24rpx"})]),_:1})]),_:1})]),_:1},8,["banner-src"])]),_:1})}}}),[["__scopeId","data-v-e21bbca7"]]);export{j as default};
