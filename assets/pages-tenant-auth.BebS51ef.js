import{_ as e}from"./Descriptions.vue_vue_type_script_setup_true_lang.C9lsNbVs.js";import{_ as a}from"./wd-divider.DFR9s3D0.js";import{g as l,a3 as s,m as t,f as c,d as u,p as o,D as r,a4 as n,o as d,q as i,s as p,bk as h,c as m,a as f,e as v,n as _,j as x,w as y,b,k as w,v as g,x as k,y as C,z as V,A as D,B as j,a6 as S,_ as I,b4 as $,C as E,bl as F,r as L,S as T,T as z,U as A,K as U,J as Y,G as N,aV as O,bm as P}from"./index-BoOjZWLk.js";import{_ as W}from"./PyTitle.CZQNf9rT.js";import{u as B,_ as G}from"./usePaged.CxxAaKmm.js";import{_ as M,a as q}from"./wd-tab.2slBbn7O.js";import"./wd-col.Woos3OcE.js";const H=I(u({name:"wd-search",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...l,customInputClass:s(""),modelValue:s(""),useSuffixSlot:t(!1),placeholder:String,cancelTxt:String,light:t(!1),hideCancel:t(!1),disabled:t(!1),maxlength:c(-1),placeholderLeft:t(!1),focus:t(!1),focusWhenClear:t(!1),placeholderStyle:String,placeholderClass:s("")},emits:["update:modelValue","change","clear","search","focus","blur","cancel"],setup(e,{emit:a}){const l=e,s=a,{translate:t}=o("search"),c=r(!1),u=r(!1),I=r(""),$=r(!0),E=r(!1);n(()=>l.modelValue,e=>{I.value=e,e&&(u.value=!0)},{immediate:!0}),n(()=>l.focus,e=>{if(e){if(l.disabled)return;z()}}),d(()=>{l.focus&&z()});const F=i(()=>`wd-search  ${l.light?"is-light":""}  ${l.hideCancel?"is-without-cancel":""} ${l.customClass}`),L=i(()=>{const e={display:""===I.value&&$.value?"flex":"none"};return p(e)});async function T(e){u.value=e,await h(),c.value=e}async function z(){l.disabled||(await h(100),$.value=!1,T(!0))}function A(e){I.value=e.detail.value,s("update:modelValue",e.detail.value),s("change",{value:e.detail.value})}async function U(){I.value="",l.focusWhenClear&&(E.value=!0,c.value=!1),await h(),l.focusWhenClear?($.value=!1,T(!0)):($.value=!0,T(!1)),s("change",{value:""}),s("update:modelValue",""),s("clear")}function Y({detail:{value:e}}){s("search",{value:e})}function N(){$.value=!1,s("focus",{value:I.value})}async function O(){await h(150),E.value?E.value=!1:($.value=!I.value,u.value=!$.value,c.value=!1,s("blur",{value:I.value}))}function P(){s("cancel",{value:I.value})}return(e,a)=>{const l=C,s=v,o=S;return f(),m(s,{class:x(F.value),style:_(e.customStyle)},{default:y(()=>[b(s,{class:"wd-search__block"},{default:y(()=>[w(e.$slots,"prefix",{},void 0,!0),b(s,{class:"wd-search__field"},{default:y(()=>[e.placeholderLeft?g("",!0):(f(),m(s,{key:0,style:_(L.value),class:"wd-search__cover",onClick:z},{default:y(()=>[b(k,{name:"search","custom-class":"wd-search__search-icon"}),b(l,{class:x(`wd-search__placeholder-txt ${e.placeholderClass}`)},{default:y(()=>[V(D(e.placeholder||j(t)("search")),1)]),_:1},8,["class"])]),_:1},8,["style"])),u.value||I.value||e.placeholderLeft?(f(),m(k,{key:1,name:"search","custom-class":"wd-search__search-left-icon"})):g("",!0),u.value||I.value||e.placeholderLeft?(f(),m(o,{key:2,placeholder:e.placeholder||j(t)("search"),"placeholder-class":`wd-search__placeholder-txt ${e.placeholderClass}`,"placeholder-style":e.placeholderStyle,"confirm-type":"search",modelValue:I.value,"onUpdate:modelValue":a[0]||(a[0]=e=>I.value=e),class:x(["wd-search__input",e.customInputClass]),onFocus:N,onInput:A,onBlur:O,onConfirm:Y,disabled:e.disabled,maxlength:e.maxlength,focus:c.value},null,8,["placeholder","placeholder-class","placeholder-style","modelValue","class","disabled","maxlength","focus"])):g("",!0),I.value?(f(),m(k,{key:3,"custom-class":"wd-search__clear wd-search__clear-icon",name:"error-fill",onClick:U})):g("",!0)]),_:1})]),_:3}),e.hideCancel?g("",!0):w(e.$slots,"suffix",{key:0},()=>[b(s,{class:"wd-search__cancel",onClick:P},{default:y(()=>[V(D(e.cancelTxt||j(t)("cancel")),1)]),_:1})],!0)]),_:3},8,["class","style"])}}}),[["__scopeId","data-v-7650d631"]]),J=I(u({__name:"auth",setup(l){const s=[{key:"999",title:"全部"},{key:"1",title:"已授权"},{key:"0",title:"未授权"}],t=$({name:"",tab:"999"});const{list:c,reload:u}=B(async function(e){const a=await O.app.getAppAuthPage({params:{...e,name:t.name||void 0,status:"999"===t.tab?void 0:Number(t.tab)}}),{code:l,data:s}=a||{};if(0!==l||!s)throw new Error("获取数据失败");return s}),o=P(u,600);n(()=>t.name,(e,a)=>{e!==a&&o()}),n(()=>t.tab,(e,a)=>{e!==a&&u()});const{confirm:r}=E(),{loading:d,close:i}=F();function p(e,a){if(!e)return;const l=0===a?1:0;r({title:"提示",msg:0===a?"确认要授权给该商户么？":"确认取消授权？取消后该商户无法再为您发放到场数字存根，可能会影响您后续相关权益领取。",success:async()=>{d("正在更新..."),await O.app.updateAppAuthTenant({data:{id:e,status:l}});const a=c.value.findIndex(a=>a.id===e);-1!==a&&c.value.splice(a,1,{...c.value[a],status:l}),i()}})}return(l,u)=>{const o=H,r=q,n=M,d=v,i=G,h=U,_=W,x=Y,w=a,k=e,C=L("layout-default-uni");return f(),m(C,null,{default:y(()=>[b(d,{class:"tenant-auth pt-54rpx pb-158rpx px-30rpx min-h-screen w-screen bg-white"},{default:y(()=>[b(d,null,{default:y(()=>[b(o,{"custom-class":"border-#DFE6ED border-solid border-2rpx rounded-100rpx",placeholder:"搜索授权商户",modelValue:j(t).name,"onUpdate:modelValue":u[0]||(u[0]=e=>j(t).name=e),"hide-cancel":""},null,8,["modelValue"]),b(n,{type:"long",modelValue:j(t).tab,"onUpdate:modelValue":u[1]||(u[1]=e=>j(t).tab=e),class:"mb-16rpx"},{default:y(()=>[(f(),T(z,null,A(s,e=>b(r,{key:e.key,title:`${e.title}`,name:e.key},null,8,["title","name"])),64))]),_:1},8,["modelValue"])]),_:1}),0===j(c).length?(f(),m(d,{key:0},{default:y(()=>[b(i)]),_:1})):g("",!0),(f(!0),T(z,null,A(j(c),e=>(f(),m(d,{key:e.id,class:"bg-#EFF2F5 rounded-18rpx py-30rpx px-34rpx mb-20rpx"},{default:y(()=>[b(d,{class:"gap-24rpx flex items-center"},{default:y(()=>[b(h,{"custom-class":"rounded-10rpx overflow-hidden flex-shrink-0",src:e.authObjectLogoUrl,width:"80rpx",height:"80rpx"},null,8,["src"]),b(_,{text:e.authObjectName,size:"36rpx","line-height":"54rpx"},null,8,["text"]),b(d,{class:"flex-grow"}),0===e.status?(f(),m(x,{key:0,"custom-class":"flex-shrink-0",size:"small",onClick:a=>p(e.id,e.status)},{default:y(()=>[V(" 去授权 ")]),_:2},1032,["onClick"])):g("",!0),1===e.status?(f(),m(x,{key:1,"custom-class":"flex-shrink-0",size:"small",type:"error",plain:"",onClick:a=>p(e.id,e.status)},{default:y(()=>[V(" 取消授权 ")]),_:2},1032,["onClick"])):g("",!0)]),_:2},1024),b(w,{class:"!my-20rpx !mx-0 !p-0",dashed:"",color:"#DFE6ED"}),b(k,{"value-color":"#333",data:[{label:"授权内容：",value:"到场证明"},{label:"授权时间：",value:j(N)(e.authTime,"YYYY年MM月DD日")},{label:"商户DID：",value:e.authObjectDid}]},null,8,["data"])]),_:2},1024))),128))]),_:1})]),_:1})}}}),[["__scopeId","data-v-9988d62d"]]);export{J as default};
