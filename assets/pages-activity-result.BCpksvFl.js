import{a9 as e,aa as t,ab as a,ac as r,ad as s,ae as o,af as n,ag as c,ah as i,ai as d,aj as l,ak as u,al as p,am as m,an as f,ao as x,ap as _,aq as h,ar as E,as as g,at as v,au as y,av as S,aw as b,ax as C,ay as k,az as w,aA as j,aB as R,aC as U,aD as T,aE as N,aF as O,aG as P,aH as A,aI as H,aJ as K,aK as z,aL as D,aM as F,aN as W,aO as q,aP as I,d as L,H as G,B as M,P as Q,c as B,w as V,r as J,a as X,b as $,e as Y,v as Z,A as ee,V as te,W as ae,X as re,t as se,D as oe,y as ne,_ as ce}from"./index-a6TtsOgc.js";import{_ as ie}from"./GradientText.vue_vue_type_script_setup_true_lang.BaEWYYVF.js";import{_ as de}from"./PyText.vue_vue_type_script_setup_true_lang.C4vd1DLX.js";import{_ as le}from"./PyTitle.CL2zNIOD.js";import{u as ue}from"./useRouteState.CRSHlu1-.js";import{u as pe}from"./usePageOptions.B-ChW6vP.js";import"./wd-text.O2Z1f8vu.js";import"./index.CVFvtcrF.js";import"./_commonjsHelpers.lGe4XDVY.js";const me=(e,t)=>{let a=F;return function(...r){const s=e.bind(this,...r),o=U(t)?t:t(...r);a&&H(a),o>0?a=y(s,o):s()}};var fe,xe;(xe=fe||(fe={}))[xe.USE_REQUEST=1]="USE_REQUEST",xe[xe.USE_WATCHER=2]="USE_WATCHER",xe[xe.USE_FETCHER=3]="USE_FETCHER";const _e=s("useRequest"),he=s("useWatcher"),Ee=s("useFetcher"),ge=e=>({[fe.USE_REQUEST]:_e,[fe.USE_WATCHER]:he,[fe.USE_FETCHER]:Ee}[e]),ve="success",ye="error",Se="complete";class be{constructor(e,t){this.method=e,this.args=t}clone(){return{...this}}static spawn(e,t){return b(be,e,t)}}class Ce extends be{constructor(e,t,a){super(e.method,e.args),this.data=t,this.fromCache=a}}class ke extends be{constructor(e,t){super(e.method,e.args),this.error=t}}class we extends be{constructor(e,t,a,r,s){super(e.method,e.args),this.status=t,this.data=a,this.fromCache="error"!==t&&r,this.error=s}}const je=(e,t)=>t(),Re={};function Ue(a,s,n=[]){const d=ge(a.ht);let l=r(s,d,n);const{fs:m,ht:f,c:x}=a,{loading:_,data:h,error:g}=m,v=f===fe.USE_FETCHER,{force:y=t,middleware:C=je}=x,k=o(l),{id:w}=k,j=c(l),{abortLast:R=e}=x,U=!a.m;return a.m=l,(async()=>{let r=z,o=t,c=N(u),k=z,T=z;const A=await O(l);let H=()=>!!A,F=t;v||(((e,t,a)=>{const r=Re[e]=Re[e]||{};r[t]||(r[t]=b(Set)),r[t].add(a)})(w,j,a),r=()=>((e,t,a)=>{const r=Re[e],s=r[t];r&&s&&(a?s.delete(a):s.clear(),0===s.size&&D(r,t))})(w,j,a));const W=s=>{o=e;const{force:i=y,method:d=l}=s||{},u=p(i,[b(be,l,n)]),f=e=>({loaded:t,total:a})=>{m[e].v={loaded:t,total:a}};l=d,a.rf[j]=r,F||(_.v=!!u||!A);const{downloading:x,uploading:h}=a.ro.trackedKeys;return k=x?l.onDownload(f("downloading")):k,T=h?l.onUpload(f("uploading")):T,c=l.send(u),H=()=>l.fromCache||t,c},q={method:l,cachedResponse:A,config:x,abort:()=>l.abort()},I=()=>f!==fe.USE_WATCHER||!R||a.m===l,L=(a=e)=>{a&&U&&(_.v=t),F=a},G=C(v?{...q,args:n,fetch:(e,...t)=>(((e,t)=>{e(i(t,K),"expected a method instance.")})(d,e),Ue(a,e,t)),proxyStates:P(m,"data"),controlLoading:L}:{...q,args:n,send:(...e)=>Ue(a,s,e),proxyStates:m,controlLoading:L},W);let M=u;const Q=be.spawn(l,n);try{const e=await G,r=e=>(v?a.c.updateState!==t&&E(((e,t)=>{const a=Re[e]||{};return a[t]?Array.from(a[t]):[]})(w,j),t=>{t.fs.data.v=e}):I()&&(h.v=e),I()&&(g.v=u,!F&&(_.v=t),a.em.emit(ve,b(Ce,Q,e,H())),a.em.emit(Se,b(we,Q,ve,e,H(),u))),e);M=e!==u?r(e):o?await S(c,r,()=>r(u)):u,!o&&!F&&(_.v=t)}catch(B){throw I()&&(g.v=B,!F&&(_.v=t),a.em.emit(ye,b(ke,Q,B)),a.em.emit(Se,b(we,Q,ye,u,H(),B))),B}return k(),T(),M})()}const Te=e=>e.current;function Ne(s,N,O,P,H=t,K,F=0){var L;O={...O};let G=!!H,M=u;if(H)try{const e=r(N,ge(s)),a=o(e),u=a.l1Cache.get(n(a.id,c(e)));if(u&&!i(u,d)){const[e,t]=u;(!t||t>l())&&(M=e)}G=!!p(null!==(L=O.force)&&void 0!==L?L:t)||!M}catch(he){}const{create:Q,effectRequest:B,ref:V,objectify:J,exposeProvider:X,transformState2Proxy:$,__referingObj:Y}=function(r,s={trackedKeys:{},bindError:t,initialRequest:t,...m()}){const o=e=>r.ref?r.ref(e):{current:e};s=o(s).current;const n=e=>(r.export||W)(e,s),c=t=>{if(!x(r.memorize))return t;const a=r.memorize(t);return a.memorized=e,a},{dehydrate:d}=r,l=(e,t,a)=>e!==d(t,a,s)&&s.trackedKeys[a]&&r.update(e,t,a,s),u=e=>j(e,e=>i(e,R)?e.e:e),p=[],f={};return{create:(e,t)=>(w(p,t),b(C,r.create(e,t,s),t,e=>d(e,t,s),n,(e,a)=>l(a,e,t))),computed:(t,a,o)=>(E(a,t=>{t.k&&(f[t.k]=e)}),b(R,r.computed(t,u(a),o,s),o,e=>d(e,o,s),n)),effectRequest:e=>r.effectRequest(e,s),ref:o,watch:(e,t)=>r.watch(u(e),t,s),onMounted:e=>r.onMounted(e,s),onUnmounted:e=>r.onUnmounted(e,s),memorize:c,__referingObj:s,exposeProvider:r=>{const o={},n={},d=[];for(const t in r){const a=r[t];if(x(a)&&!s.trackedKeys[t])o[t]=t.startsWith("on")?(...e)=>(a(...e),g):a.memorized?a:c(a);else{k(["uploading","downloading"],t)||t.startsWith("__")||w(d,t);const r=i(a,R);r&&(n[t]=a.s),q.defineProperty(o,t,{get:()=>(s.trackedKeys[t]=e,r?a.e:a),set:z,enumerable:e,configurable:e})}}const{update:u,__proxyState:m}=o;s.trackedKeys={...f},s.bindError=t;const{then:_}=o,h={__referingObj:s,update:c(e=>{A(e).forEach(t=>{k(p,t)?l(e[t],n[t],t):t in o&&x(u)&&u({[t]:e[t]})})}),__proxyState:c(t=>k(p,t)&&i(r[t],R)?(s.trackedKeys[t]=e,r[t]):m(t)),then(t,a){E(d,t=>{s.trackedKeys[t]=e});const r=()=>{D(g,"then"),t(g)};x(_)?_(r,a):r()}},g=a(o,h);return g},objectify:(e,t)=>e.reduce((e,a)=>(e[a.k]=t?a[t]:a,e),{}),transformState2Proxy:(e,t)=>b(C,e,t,e=>d(e,t,s),n,(e,a)=>l(a,e,t))}}(f(),O.__referingObj),Z={total:0,loaded:0},{managedStates:ee={}}=O,te=((e,t)=>{const a={};for(const r in e)a[r]=t(e[r],r,e);return a})(ee,(e,t)=>$(e,t)),ae=Q(null!=M?M:x(P)?P():P,"data"),re=Q(G,"loading"),se=Q(u,"error"),oe=Q({...Z},"downloading"),ne=Q({...Z},"uploading"),ce=J([ae,re,se,oe,ne]),ie=_(),de=Te(V(((e,t,a,r)=>({m:u,rf:{},fs:{},em:a,ht:e,c:t,ro:r,ms:{}}))(s,O,ie,Y)));de.fs=ce,de.em=ie,de.c=O,de.ms={...ce,...te};const le=(e=N,t)=>Ue(de,e,t),ue=V(u),pe=V(t),fe=Te(V(h())),xe=(t=Y,a)=>{fe(()=>{T.ssr&&!Te(ue)||(Y.initialRequest=pe.current=e,S(le(a),()=>{var e;null===(e=Te(ue))||void 0===e||e.resolve()},e=>{var a;if(!t.bindError&&!t.trackedKeys.error&&!Te(ue))throw e;null===(a=Te(ue))||void 0===a||a.reject(e)}))})};V(me((e,t,a)=>xe(t,a),e=>U(e)?I(F)?F[e]:F:0)),B({handler:()=>xe(Y),removeStates:()=>{E(g(de.rf),e=>e())},frontStates:{...ce,...te},watchingStates:K,immediate:null!=H?H:e});const _e=X({...J([ae,re,se,oe,ne]),abort:()=>de.m&&de.m.abort(),send:(e,t)=>le(t,e),onSuccess(e){ie.on(ve,e)},onError(t){Y.bindError=e,ie.on(ye,t)},onComplete(e){ie.on(Se,e)},then(e,t){const{promise:a,resolve:r,reject:s}=v();ue.current={resolve:r,reject:s},y(()=>{!pe.current&&r()},10),S(a,()=>{e(_e)},t)}});return _e}var Oe,Pe,Ae,He;(Pe=Oe||(Oe={}))[Pe.CONNECTING=0]="CONNECTING",Pe[Pe.OPEN=1]="OPEN",Pe[Pe.CLOSED=2]="CLOSED",(He=Ae||(Ae={})).Open="open",He.Error="error",He.Message="message",He.Close="close";const Ke=ce(L({__name:"result",setup(t){const r=G(),s=ue(),o=M(),{data:n,send:c}=function(t,r={}){const{immediate:s=e,initialData:o}=r,n=Ne(fe.USE_REQUEST,t,r,o,!!s),{send:c}=n;return a(n,{send:(...e)=>c(e)})}(Q.app.getActivity,{immediate:!1});function i(){r.replaceAll({name:"profit"})}return pe(async e=>{const{id:t,pageUUID:a}=e||{},r=Number.parseInt(t,10);t&&!Number.isNaN(r)&&(a&&(o.value=s.withdrawRouteState(a)),c({params:{id:r}}))}),(e,t)=>{const a=Z,s=le,c=de,d=ie,l=Y,u=oe,p=J("layout-default-uni");return X(),B(p,null,{default:V(()=>[$(l,{class:"p-64rpx bg-#f5f5f5 flex h-screen w-screen flex-col items-center justify-center"},{default:V(()=>[$(l,{class:"result-card bg-#fff rounded-24rpx py-64rpx px-32rpx gap-16rpx flex w-full flex-col items-center"},{default:V(()=>[$(a,{name:"check-outline",size:"148rpx",color:"#34d19d"}),$(l,{class:"gap-2rpx flex flex-col items-center"},{default:V(()=>{var e,t;return[$(s,{text:"恭喜您！"}),$(c,{text:`已成功参加“${(null==(t=null==(e=ee(n))?void 0:e.data)?void 0:t.name)||""}”活动`},null,8,["text"]),$(l,{class:"gap-4rpx mt-4rpx flex flex-col"},{default:V(()=>{var e;return[(X(!0),te(ae,null,re(((null==(e=ee(o))?void 0:e.succeedProducts)||[]).filter(e=>e.id&&2===Number(e.productSpuType)),e=>(X(),B(l,{key:e.id,class:"bg-#FF6A001A rounded-96rpx py-4rpx px-12rpx",onClick:t=>{return a=e.id,void r.push({name:"profitDetail",params:{id:String(a)}});var a}},{default:V(()=>[$(d,{"custom-class":"text-24rpx leading-28rpx",text:e.productSpuName},null,8,["text"])]),_:2},1032,["onClick"]))),128))]}),_:1})]}),_:1}),$(l,{class:"gap-24rpx px-24rpx mt-48rpx flex w-full flex-col"},{default:V(()=>{var e,t;return[((null==(t=null==(e=ee(n))?void 0:e.data)?void 0:t.issueVoucher)||[]).length>0?(X(),B(u,{key:0,block:"",onClick:i},{default:V(()=>[ne(" 查看我的权益 ")]),_:1})):se("",!0),$(u,{block:"",plain:"",onClick:ee(r).back},{default:V(()=>[ne("返回活动详情")]),_:1},8,["onClick"])]}),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-54ec4f5d"]]);export{Ke as default};
