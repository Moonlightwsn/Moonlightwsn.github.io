import{d as e,bI as a,bJ as l,H as s,C as t,a_ as o,c as r,w as n,r as i,a as u,b as d,A as c,e as m,a$ as p,F as f,y as x,E as _,bK as b,D as v,_ as g}from"./index-2e8oLCEa.js";import{_ as y}from"./BannerView.vue_vue_type_script_setup_true_lang.DORrD1Jx.js";import{_ as w}from"./wd-form.DcBcTtQe.js";import{l as h}from"./pythroot-banner.02EEHkli.js";import{_ as V}from"./SmsCodeBtn.vue_vue_type_script_setup_true_lang.DZP5l3vE.js";const I=g(e({__name:"index",setup(e){const g=a(),I=l("tenant_id",""),j=s(),k=t(),C=o({code:"",mobile:""}),q=t(!1);async function z(){return await k.value.validate()}async function T(){var e,a;if(q.value)return;const{valid:l}=await k.value.validate();if(l)try{q.value=!0;const l=await b.general.smsLogin({data:{...C,templateIdList:[1,2]}});if((null==(e=null==l?void 0:l.data)?void 0:e.accessToken)&&(null==(a=null==l?void 0:l.data)?void 0:a.tenantId)){const{accessToken:e,tenantId:a}=l.data;g.value=e,I.value=a,v({icon:"success",title:"登录成功",success(){setTimeout(()=>{j.replaceAll({name:"merchantProfile"})},1e3)}})}else v({icon:"error",title:(null==l?void 0:l.msg)||"登录失败"})}finally{q.value=!1}}const A=/^\d{11}$/;function B(e){return!(C.mobile&&A.test(C.mobile)&&!e)}return(e,a)=>{const l=p,s=f,t=w,o=m,b=_,v=y,g=i("layout-default-uni");return u(),r(g,null,{default:n(()=>[d(v,{fixed:!1,"custom-class":"bg-white login-page","banner-src":c(h),"banner-height":"364rpx"},{default:n(()=>[d(o,{class:"py-60rpx px-56rpx flex h-full flex-grow flex-col"},{default:n(()=>[d(t,{ref_key:"form",ref:k,"custom-class":"gap-16rpx flex flex-col",model:c(C)},{default:n(()=>[d(l,{modelValue:c(C).mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>c(C).mobile=e),prop:"mobile",rules:[{required:!0,message:"请输入手机号"},{required:!1,pattern:A,message:"手机号格式不正确"}],"custom-class":"rounded-10rpx px-28rpx","no-border":"",type:"digit","input-mode":"numeric",placeholder:"请输入手机号"},null,8,["modelValue","rules"]),d(l,{modelValue:c(C).code,"onUpdate:modelValue":a[1]||(a[1]=e=>c(C).code=e),prop:"code",rules:[{required:!1,validator:B,message:"请输入验证码"}],"custom-class":"rounded-10rpx px-28rpx","no-border":"",type:"text","input-mode":"text",placeholder:"请输入验证码"},{suffix:n(()=>[d(V,{mobile:c(C).mobile,"is-admin":!0,onValidate:z},null,8,["mobile"])]),_:1},8,["modelValue","rules"]),d(s,{type:"primary",block:"",size:"large",round:!1,disabled:c(q),onClick:T},{default:n(()=>[x(" 登录 ")]),_:1},8,["disabled"])]),_:1},8,["model"]),d(o,{class:"flex-grow"}),d(o,{class:"flex flex-col items-center"},{default:n(()=>[d(b,{text:"浦江数链提供技术支持",color:"#999",size:"24rpx"}),d(b,{text:"沪ICP备2023032312号-2",color:"#999",size:"24rpx"})]),_:1})]),_:1})]),_:1},8,["banner-src"])]),_:1})}}}),[["__scopeId","data-v-b2c26e63"]]);export{I as default};
